"use strict";
(self["webpackChunkavalanche_extension"] = self["webpackChunkavalanche_extension"] || []).push([["vendors-node_modules_react-custom-scrollbars-2_lib_index_js"],{

/***/ "./node_modules/react-custom-scrollbars-2/lib/Scrollbars/defaultRenderElements.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/react-custom-scrollbars-2/lib/Scrollbars/defaultRenderElements.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {



Object.defineProperty(exports, "__esModule", ({
    value: true
}));

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

exports.renderViewDefault = renderViewDefault;
exports.renderTrackHorizontalDefault = renderTrackHorizontalDefault;
exports.renderTrackVerticalDefault = renderTrackVerticalDefault;
exports.renderThumbHorizontalDefault = renderThumbHorizontalDefault;
exports.renderThumbVerticalDefault = renderThumbVerticalDefault;

var _react = __webpack_require__(/*! react */ "./node_modules/react/index.js");

var _react2 = _interopRequireDefault(_react);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }

/* eslint-disable react/prop-types */

function renderViewDefault(props) {
    return _react2["default"].createElement('div', props);
}

function renderTrackHorizontalDefault(_ref) {
    var style = _ref.style,
        props = _objectWithoutProperties(_ref, ['style']);

    var finalStyle = _extends({}, style, {
        right: 2,
        bottom: 2,
        left: 2,
        borderRadius: 3
    });
    return _react2["default"].createElement('div', _extends({ style: finalStyle }, props));
}

function renderTrackVerticalDefault(_ref2) {
    var style = _ref2.style,
        props = _objectWithoutProperties(_ref2, ['style']);

    var finalStyle = _extends({}, style, {
        right: 2,
        bottom: 2,
        top: 2,
        borderRadius: 3
    });
    return _react2["default"].createElement('div', _extends({ style: finalStyle }, props));
}

function renderThumbHorizontalDefault(_ref3) {
    var style = _ref3.style,
        props = _objectWithoutProperties(_ref3, ['style']);

    var finalStyle = _extends({}, style, {
        cursor: 'pointer',
        borderRadius: 'inherit',
        backgroundColor: 'rgba(0,0,0,.2)'
    });
    return _react2["default"].createElement('div', _extends({ style: finalStyle }, props));
}

function renderThumbVerticalDefault(_ref4) {
    var style = _ref4.style,
        props = _objectWithoutProperties(_ref4, ['style']);

    var finalStyle = _extends({}, style, {
        cursor: 'pointer',
        borderRadius: 'inherit',
        backgroundColor: 'rgba(0,0,0,.2)'
    });
    return _react2["default"].createElement('div', _extends({ style: finalStyle }, props));
}

/***/ }),

/***/ "./node_modules/react-custom-scrollbars-2/lib/Scrollbars/index.js":
/*!************************************************************************!*\
  !*** ./node_modules/react-custom-scrollbars-2/lib/Scrollbars/index.js ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {



Object.defineProperty(exports, "__esModule", ({
    value: true
}));

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _raf2 = __webpack_require__(/*! raf */ "./node_modules/raf/index.js");

var _raf3 = _interopRequireDefault(_raf2);

var _domCss = __webpack_require__(/*! dom-css */ "./node_modules/dom-css/index.js");

var _domCss2 = _interopRequireDefault(_domCss);

var _react = __webpack_require__(/*! react */ "./node_modules/react/index.js");

var _propTypes = __webpack_require__(/*! prop-types */ "./node_modules/prop-types/index.js");

var _propTypes2 = _interopRequireDefault(_propTypes);

var _isString = __webpack_require__(/*! ../utils/isString */ "./node_modules/react-custom-scrollbars-2/lib/utils/isString.js");

var _isString2 = _interopRequireDefault(_isString);

var _getScrollbarWidth = __webpack_require__(/*! ../utils/getScrollbarWidth */ "./node_modules/react-custom-scrollbars-2/lib/utils/getScrollbarWidth.js");

var _getScrollbarWidth2 = _interopRequireDefault(_getScrollbarWidth);

var _returnFalse = __webpack_require__(/*! ../utils/returnFalse */ "./node_modules/react-custom-scrollbars-2/lib/utils/returnFalse.js");

var _returnFalse2 = _interopRequireDefault(_returnFalse);

var _getInnerWidth = __webpack_require__(/*! ../utils/getInnerWidth */ "./node_modules/react-custom-scrollbars-2/lib/utils/getInnerWidth.js");

var _getInnerWidth2 = _interopRequireDefault(_getInnerWidth);

var _getInnerHeight = __webpack_require__(/*! ../utils/getInnerHeight */ "./node_modules/react-custom-scrollbars-2/lib/utils/getInnerHeight.js");

var _getInnerHeight2 = _interopRequireDefault(_getInnerHeight);

var _styles = __webpack_require__(/*! ./styles */ "./node_modules/react-custom-scrollbars-2/lib/Scrollbars/styles.js");

var _defaultRenderElements = __webpack_require__(/*! ./defaultRenderElements */ "./node_modules/react-custom-scrollbars-2/lib/Scrollbars/defaultRenderElements.js");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var Scrollbars = function (_Component) {
    _inherits(Scrollbars, _Component);

    function Scrollbars(props) {
        var _ref;

        _classCallCheck(this, Scrollbars);

        for (var _len = arguments.length, rest = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
            rest[_key - 1] = arguments[_key];
        }

        var _this = _possibleConstructorReturn(this, (_ref = Scrollbars.__proto__ || Object.getPrototypeOf(Scrollbars)).call.apply(_ref, [this, props].concat(rest)));

        _this.getScrollLeft = _this.getScrollLeft.bind(_this);
        _this.getScrollTop = _this.getScrollTop.bind(_this);
        _this.getScrollWidth = _this.getScrollWidth.bind(_this);
        _this.getScrollHeight = _this.getScrollHeight.bind(_this);
        _this.getClientWidth = _this.getClientWidth.bind(_this);
        _this.getClientHeight = _this.getClientHeight.bind(_this);
        _this.getValues = _this.getValues.bind(_this);
        _this.getThumbHorizontalWidth = _this.getThumbHorizontalWidth.bind(_this);
        _this.getThumbVerticalHeight = _this.getThumbVerticalHeight.bind(_this);
        _this.getScrollLeftForOffset = _this.getScrollLeftForOffset.bind(_this);
        _this.getScrollTopForOffset = _this.getScrollTopForOffset.bind(_this);

        _this.scrollLeft = _this.scrollLeft.bind(_this);
        _this.scrollTop = _this.scrollTop.bind(_this);
        _this.scrollToLeft = _this.scrollToLeft.bind(_this);
        _this.scrollToTop = _this.scrollToTop.bind(_this);
        _this.scrollToRight = _this.scrollToRight.bind(_this);
        _this.scrollToBottom = _this.scrollToBottom.bind(_this);

        _this.handleTrackMouseEnter = _this.handleTrackMouseEnter.bind(_this);
        _this.handleTrackMouseLeave = _this.handleTrackMouseLeave.bind(_this);
        _this.handleHorizontalTrackMouseDown = _this.handleHorizontalTrackMouseDown.bind(_this);
        _this.handleVerticalTrackMouseDown = _this.handleVerticalTrackMouseDown.bind(_this);
        _this.handleHorizontalThumbMouseDown = _this.handleHorizontalThumbMouseDown.bind(_this);
        _this.handleVerticalThumbMouseDown = _this.handleVerticalThumbMouseDown.bind(_this);
        _this.handleWindowResize = _this.handleWindowResize.bind(_this);
        _this.handleScroll = _this.handleScroll.bind(_this);
        _this.handleDrag = _this.handleDrag.bind(_this);
        _this.handleDragEnd = _this.handleDragEnd.bind(_this);

        _this.state = {
            didMountUniversal: false
        };
        return _this;
    }

    _createClass(Scrollbars, [{
        key: 'componentDidMount',
        value: function componentDidMount() {
            this.addListeners();
            this.update();
            this.componentDidMountUniversal();
        }
    }, {
        key: 'componentDidMountUniversal',
        value: function componentDidMountUniversal() {
            // eslint-disable-line react/sort-comp
            var universal = this.props.universal;

            if (!universal) return;
            this.setState({ didMountUniversal: true });
        }
    }, {
        key: 'componentDidUpdate',
        value: function componentDidUpdate() {
            this.update();
        }
    }, {
        key: 'componentWillUnmount',
        value: function componentWillUnmount() {
            this.removeListeners();
            (0, _raf2.cancel)(this.requestFrame);
            clearTimeout(this.hideTracksTimeout);
            clearInterval(this.detectScrollingInterval);
        }
    }, {
        key: 'getScrollLeft',
        value: function getScrollLeft() {
            if (!this.view) return 0;
            return this.view.scrollLeft;
        }
    }, {
        key: 'getScrollTop',
        value: function getScrollTop() {
            if (!this.view) return 0;
            return this.view.scrollTop;
        }
    }, {
        key: 'getScrollWidth',
        value: function getScrollWidth() {
            if (!this.view) return 0;
            return this.view.scrollWidth;
        }
    }, {
        key: 'getScrollHeight',
        value: function getScrollHeight() {
            if (!this.view) return 0;
            return this.view.scrollHeight;
        }
    }, {
        key: 'getClientWidth',
        value: function getClientWidth() {
            if (!this.view) return 0;
            return this.view.clientWidth;
        }
    }, {
        key: 'getClientHeight',
        value: function getClientHeight() {
            if (!this.view) return 0;
            return this.view.clientHeight;
        }
    }, {
        key: 'getValues',
        value: function getValues() {
            var _ref2 = this.view || {},
                _ref2$scrollLeft = _ref2.scrollLeft,
                scrollLeft = _ref2$scrollLeft === undefined ? 0 : _ref2$scrollLeft,
                _ref2$scrollTop = _ref2.scrollTop,
                scrollTop = _ref2$scrollTop === undefined ? 0 : _ref2$scrollTop,
                _ref2$scrollWidth = _ref2.scrollWidth,
                scrollWidth = _ref2$scrollWidth === undefined ? 0 : _ref2$scrollWidth,
                _ref2$scrollHeight = _ref2.scrollHeight,
                scrollHeight = _ref2$scrollHeight === undefined ? 0 : _ref2$scrollHeight,
                _ref2$clientWidth = _ref2.clientWidth,
                clientWidth = _ref2$clientWidth === undefined ? 0 : _ref2$clientWidth,
                _ref2$clientHeight = _ref2.clientHeight,
                clientHeight = _ref2$clientHeight === undefined ? 0 : _ref2$clientHeight;

            return {
                left: scrollLeft / (scrollWidth - clientWidth) || 0,
                top: scrollTop / (scrollHeight - clientHeight) || 0,
                scrollLeft: scrollLeft,
                scrollTop: scrollTop,
                scrollWidth: scrollWidth,
                scrollHeight: scrollHeight,
                clientWidth: clientWidth,
                clientHeight: clientHeight
            };
        }
    }, {
        key: 'getThumbHorizontalWidth',
        value: function getThumbHorizontalWidth() {
            var _props = this.props,
                thumbSize = _props.thumbSize,
                thumbMinSize = _props.thumbMinSize;
            var _view = this.view,
                scrollWidth = _view.scrollWidth,
                clientWidth = _view.clientWidth;

            var trackWidth = (0, _getInnerWidth2["default"])(this.trackHorizontal);
            var width = Math.ceil(clientWidth / scrollWidth * trackWidth);
            if (trackWidth <= width) return 0;
            if (thumbSize) return thumbSize;
            return Math.max(width, thumbMinSize);
        }
    }, {
        key: 'getThumbVerticalHeight',
        value: function getThumbVerticalHeight() {
            var _props2 = this.props,
                thumbSize = _props2.thumbSize,
                thumbMinSize = _props2.thumbMinSize;
            var _view2 = this.view,
                scrollHeight = _view2.scrollHeight,
                clientHeight = _view2.clientHeight;

            var trackHeight = (0, _getInnerHeight2["default"])(this.trackVertical);
            var height = Math.ceil(clientHeight / scrollHeight * trackHeight);
            if (trackHeight <= height) return 0;
            if (thumbSize) return thumbSize;
            return Math.max(height, thumbMinSize);
        }
    }, {
        key: 'getScrollLeftForOffset',
        value: function getScrollLeftForOffset(offset) {
            var _view3 = this.view,
                scrollWidth = _view3.scrollWidth,
                clientWidth = _view3.clientWidth;

            var trackWidth = (0, _getInnerWidth2["default"])(this.trackHorizontal);
            var thumbWidth = this.getThumbHorizontalWidth();
            return offset / (trackWidth - thumbWidth) * (scrollWidth - clientWidth);
        }
    }, {
        key: 'getScrollTopForOffset',
        value: function getScrollTopForOffset(offset) {
            var _view4 = this.view,
                scrollHeight = _view4.scrollHeight,
                clientHeight = _view4.clientHeight;

            var trackHeight = (0, _getInnerHeight2["default"])(this.trackVertical);
            var thumbHeight = this.getThumbVerticalHeight();
            return offset / (trackHeight - thumbHeight) * (scrollHeight - clientHeight);
        }
    }, {
        key: 'scrollLeft',
        value: function scrollLeft() {
            var left = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;

            if (!this.view) return;
            this.view.scrollLeft = left;
        }
    }, {
        key: 'scrollTop',
        value: function scrollTop() {
            var top = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;

            if (!this.view) return;
            this.view.scrollTop = top;
        }
    }, {
        key: 'scrollToLeft',
        value: function scrollToLeft() {
            if (!this.view) return;
            this.view.scrollLeft = 0;
        }
    }, {
        key: 'scrollToTop',
        value: function scrollToTop() {
            if (!this.view) return;
            this.view.scrollTop = 0;
        }
    }, {
        key: 'scrollToRight',
        value: function scrollToRight() {
            if (!this.view) return;
            this.view.scrollLeft = this.view.scrollWidth;
        }
    }, {
        key: 'scrollToBottom',
        value: function scrollToBottom() {
            if (!this.view) return;
            this.view.scrollTop = this.view.scrollHeight;
        }
    }, {
        key: 'addListeners',
        value: function addListeners() {
            /* istanbul ignore if */
            if (typeof document === 'undefined' || !this.view) return;
            var view = this.view,
                trackHorizontal = this.trackHorizontal,
                trackVertical = this.trackVertical,
                thumbHorizontal = this.thumbHorizontal,
                thumbVertical = this.thumbVertical;

            view.addEventListener('scroll', this.handleScroll);
            if (!(0, _getScrollbarWidth2["default"])()) return;
            trackHorizontal.addEventListener('mouseenter', this.handleTrackMouseEnter);
            trackHorizontal.addEventListener('mouseleave', this.handleTrackMouseLeave);
            trackHorizontal.addEventListener('mousedown', this.handleHorizontalTrackMouseDown);
            trackVertical.addEventListener('mouseenter', this.handleTrackMouseEnter);
            trackVertical.addEventListener('mouseleave', this.handleTrackMouseLeave);
            trackVertical.addEventListener('mousedown', this.handleVerticalTrackMouseDown);
            thumbHorizontal.addEventListener('mousedown', this.handleHorizontalThumbMouseDown);
            thumbVertical.addEventListener('mousedown', this.handleVerticalThumbMouseDown);
            window.addEventListener('resize', this.handleWindowResize);
        }
    }, {
        key: 'removeListeners',
        value: function removeListeners() {
            /* istanbul ignore if */
            if (typeof document === 'undefined' || !this.view) return;
            var view = this.view,
                trackHorizontal = this.trackHorizontal,
                trackVertical = this.trackVertical,
                thumbHorizontal = this.thumbHorizontal,
                thumbVertical = this.thumbVertical;

            view.removeEventListener('scroll', this.handleScroll);
            if (!(0, _getScrollbarWidth2["default"])()) return;
            trackHorizontal.removeEventListener('mouseenter', this.handleTrackMouseEnter);
            trackHorizontal.removeEventListener('mouseleave', this.handleTrackMouseLeave);
            trackHorizontal.removeEventListener('mousedown', this.handleHorizontalTrackMouseDown);
            trackVertical.removeEventListener('mouseenter', this.handleTrackMouseEnter);
            trackVertical.removeEventListener('mouseleave', this.handleTrackMouseLeave);
            trackVertical.removeEventListener('mousedown', this.handleVerticalTrackMouseDown);
            thumbHorizontal.removeEventListener('mousedown', this.handleHorizontalThumbMouseDown);
            thumbVertical.removeEventListener('mousedown', this.handleVerticalThumbMouseDown);
            window.removeEventListener('resize', this.handleWindowResize);
            // Possibly setup by `handleDragStart`
            this.teardownDragging();
        }
    }, {
        key: 'handleScroll',
        value: function handleScroll(event) {
            var _this2 = this;

            var _props3 = this.props,
                onScroll = _props3.onScroll,
                onScrollFrame = _props3.onScrollFrame;

            if (onScroll) onScroll(event);
            this.update(function (values) {
                var scrollLeft = values.scrollLeft,
                    scrollTop = values.scrollTop;

                _this2.viewScrollLeft = scrollLeft;
                _this2.viewScrollTop = scrollTop;
                if (onScrollFrame) onScrollFrame(values);
            });
            this.detectScrolling();
        }
    }, {
        key: 'handleScrollStart',
        value: function handleScrollStart() {
            var onScrollStart = this.props.onScrollStart;

            if (onScrollStart) onScrollStart();
            this.handleScrollStartAutoHide();
        }
    }, {
        key: 'handleScrollStartAutoHide',
        value: function handleScrollStartAutoHide() {
            var autoHide = this.props.autoHide;

            if (!autoHide) return;
            this.showTracks();
        }
    }, {
        key: 'handleScrollStop',
        value: function handleScrollStop() {
            var onScrollStop = this.props.onScrollStop;

            if (onScrollStop) onScrollStop();
            this.handleScrollStopAutoHide();
        }
    }, {
        key: 'handleScrollStopAutoHide',
        value: function handleScrollStopAutoHide() {
            var autoHide = this.props.autoHide;

            if (!autoHide) return;
            this.hideTracks();
        }
    }, {
        key: 'handleWindowResize',
        value: function handleWindowResize() {
            (0, _getScrollbarWidth2["default"])(false);
            this.forceUpdate();
        }
    }, {
        key: 'handleHorizontalTrackMouseDown',
        value: function handleHorizontalTrackMouseDown(event) {
            event.preventDefault();
            var target = event.target,
                clientX = event.clientX;

            var _target$getBoundingCl = target.getBoundingClientRect(),
                targetLeft = _target$getBoundingCl.left;

            var thumbWidth = this.getThumbHorizontalWidth();
            var offset = Math.abs(targetLeft - clientX) - thumbWidth / 2;
            this.view.scrollLeft = this.getScrollLeftForOffset(offset);
        }
    }, {
        key: 'handleVerticalTrackMouseDown',
        value: function handleVerticalTrackMouseDown(event) {
            event.preventDefault();
            var target = event.target,
                clientY = event.clientY;

            var _target$getBoundingCl2 = target.getBoundingClientRect(),
                targetTop = _target$getBoundingCl2.top;

            var thumbHeight = this.getThumbVerticalHeight();
            var offset = Math.abs(targetTop - clientY) - thumbHeight / 2;
            this.view.scrollTop = this.getScrollTopForOffset(offset);
        }
    }, {
        key: 'handleHorizontalThumbMouseDown',
        value: function handleHorizontalThumbMouseDown(event) {
            event.preventDefault();
            this.handleDragStart(event);
            var target = event.target,
                clientX = event.clientX;
            var offsetWidth = target.offsetWidth;

            var _target$getBoundingCl3 = target.getBoundingClientRect(),
                left = _target$getBoundingCl3.left;

            this.prevPageX = offsetWidth - (clientX - left);
        }
    }, {
        key: 'handleVerticalThumbMouseDown',
        value: function handleVerticalThumbMouseDown(event) {
            event.preventDefault();
            this.handleDragStart(event);
            var target = event.target,
                clientY = event.clientY;
            var offsetHeight = target.offsetHeight;

            var _target$getBoundingCl4 = target.getBoundingClientRect(),
                top = _target$getBoundingCl4.top;

            this.prevPageY = offsetHeight - (clientY - top);
        }
    }, {
        key: 'setupDragging',
        value: function setupDragging() {
            (0, _domCss2["default"])(document.body, _styles.disableSelectStyle);
            document.addEventListener('mousemove', this.handleDrag);
            document.addEventListener('mouseup', this.handleDragEnd);
            document.onselectstart = _returnFalse2["default"];
        }
    }, {
        key: 'teardownDragging',
        value: function teardownDragging() {
            (0, _domCss2["default"])(document.body, _styles.disableSelectStyleReset);
            document.removeEventListener('mousemove', this.handleDrag);
            document.removeEventListener('mouseup', this.handleDragEnd);
            document.onselectstart = undefined;
        }
    }, {
        key: 'handleDragStart',
        value: function handleDragStart(event) {
            this.dragging = true;
            event.stopImmediatePropagation();
            this.setupDragging();
        }
    }, {
        key: 'handleDrag',
        value: function handleDrag(event) {
            if (this.prevPageX) {
                var clientX = event.clientX;

                var _trackHorizontal$getB = this.trackHorizontal.getBoundingClientRect(),
                    trackLeft = _trackHorizontal$getB.left;

                var thumbWidth = this.getThumbHorizontalWidth();
                var clickPosition = thumbWidth - this.prevPageX;
                var offset = -trackLeft + clientX - clickPosition;
                this.view.scrollLeft = this.getScrollLeftForOffset(offset);
            }
            if (this.prevPageY) {
                var clientY = event.clientY;

                var _trackVertical$getBou = this.trackVertical.getBoundingClientRect(),
                    trackTop = _trackVertical$getBou.top;

                var thumbHeight = this.getThumbVerticalHeight();
                var _clickPosition = thumbHeight - this.prevPageY;
                var _offset = -trackTop + clientY - _clickPosition;
                this.view.scrollTop = this.getScrollTopForOffset(_offset);
            }
            return false;
        }
    }, {
        key: 'handleDragEnd',
        value: function handleDragEnd() {
            this.dragging = false;
            this.prevPageX = this.prevPageY = 0;
            this.teardownDragging();
            this.handleDragEndAutoHide();
        }
    }, {
        key: 'handleDragEndAutoHide',
        value: function handleDragEndAutoHide() {
            var autoHide = this.props.autoHide;

            if (!autoHide) return;
            this.hideTracks();
        }
    }, {
        key: 'handleTrackMouseEnter',
        value: function handleTrackMouseEnter() {
            this.trackMouseOver = true;
            this.handleTrackMouseEnterAutoHide();
        }
    }, {
        key: 'handleTrackMouseEnterAutoHide',
        value: function handleTrackMouseEnterAutoHide() {
            var autoHide = this.props.autoHide;

            if (!autoHide) return;
            this.showTracks();
        }
    }, {
        key: 'handleTrackMouseLeave',
        value: function handleTrackMouseLeave() {
            this.trackMouseOver = false;
            this.handleTrackMouseLeaveAutoHide();
        }
    }, {
        key: 'handleTrackMouseLeaveAutoHide',
        value: function handleTrackMouseLeaveAutoHide() {
            var autoHide = this.props.autoHide;

            if (!autoHide) return;
            this.hideTracks();
        }
    }, {
        key: 'showTracks',
        value: function showTracks() {
            clearTimeout(this.hideTracksTimeout);
            (0, _domCss2["default"])(this.trackHorizontal, { opacity: 1 });
            (0, _domCss2["default"])(this.trackVertical, { opacity: 1 });
        }
    }, {
        key: 'hideTracks',
        value: function hideTracks() {
            var _this3 = this;

            if (this.dragging) return;
            if (this.scrolling) return;
            if (this.trackMouseOver) return;
            var autoHideTimeout = this.props.autoHideTimeout;

            clearTimeout(this.hideTracksTimeout);
            this.hideTracksTimeout = setTimeout(function () {
                (0, _domCss2["default"])(_this3.trackHorizontal, { opacity: 0 });
                (0, _domCss2["default"])(_this3.trackVertical, { opacity: 0 });
            }, autoHideTimeout);
        }
    }, {
        key: 'detectScrolling',
        value: function detectScrolling() {
            var _this4 = this;

            if (this.scrolling) return;
            this.scrolling = true;
            this.handleScrollStart();
            this.detectScrollingInterval = setInterval(function () {
                if (_this4.lastViewScrollLeft === _this4.viewScrollLeft && _this4.lastViewScrollTop === _this4.viewScrollTop) {
                    clearInterval(_this4.detectScrollingInterval);
                    _this4.scrolling = false;
                    _this4.handleScrollStop();
                }
                _this4.lastViewScrollLeft = _this4.viewScrollLeft;
                _this4.lastViewScrollTop = _this4.viewScrollTop;
            }, 100);
        }
    }, {
        key: 'raf',
        value: function raf(callback) {
            var _this5 = this;

            if (this.requestFrame) _raf3["default"].cancel(this.requestFrame);
            this.requestFrame = (0, _raf3["default"])(function () {
                _this5.requestFrame = undefined;
                callback();
            });
        }
    }, {
        key: 'update',
        value: function update(callback) {
            var _this6 = this;

            this.raf(function () {
                return _this6._update(callback);
            });
        }
    }, {
        key: '_update',
        value: function _update(callback) {
            var _props4 = this.props,
                onUpdate = _props4.onUpdate,
                hideTracksWhenNotNeeded = _props4.hideTracksWhenNotNeeded;

            var values = this.getValues();
            if ((0, _getScrollbarWidth2["default"])()) {
                var scrollLeft = values.scrollLeft,
                    clientWidth = values.clientWidth,
                    scrollWidth = values.scrollWidth;

                var trackHorizontalWidth = (0, _getInnerWidth2["default"])(this.trackHorizontal);
                var thumbHorizontalWidth = this.getThumbHorizontalWidth();
                var thumbHorizontalX = scrollLeft / (scrollWidth - clientWidth) * (trackHorizontalWidth - thumbHorizontalWidth);
                var thumbHorizontalStyle = {
                    width: thumbHorizontalWidth,
                    transform: 'translateX(' + thumbHorizontalX + 'px)'
                };
                var scrollTop = values.scrollTop,
                    clientHeight = values.clientHeight,
                    scrollHeight = values.scrollHeight;

                var trackVerticalHeight = (0, _getInnerHeight2["default"])(this.trackVertical);
                var thumbVerticalHeight = this.getThumbVerticalHeight();
                var thumbVerticalY = scrollTop / (scrollHeight - clientHeight) * (trackVerticalHeight - thumbVerticalHeight);
                var thumbVerticalStyle = {
                    height: thumbVerticalHeight,
                    transform: 'translateY(' + thumbVerticalY + 'px)'
                };
                if (hideTracksWhenNotNeeded) {
                    var trackHorizontalStyle = {
                        visibility: scrollWidth > clientWidth ? 'visible' : 'hidden'
                    };
                    var trackVerticalStyle = {
                        visibility: scrollHeight > clientHeight ? 'visible' : 'hidden'
                    };
                    (0, _domCss2["default"])(this.trackHorizontal, trackHorizontalStyle);
                    (0, _domCss2["default"])(this.trackVertical, trackVerticalStyle);
                }
                (0, _domCss2["default"])(this.thumbHorizontal, thumbHorizontalStyle);
                (0, _domCss2["default"])(this.thumbVertical, thumbVerticalStyle);
            }
            if (onUpdate) onUpdate(values);
            if (typeof callback !== 'function') return;
            callback(values);
        }
    }, {
        key: 'render',
        value: function render() {
            var _this7 = this;

            var scrollbarWidth = (0, _getScrollbarWidth2["default"])();
            /* eslint-disable no-unused-vars */

            var _props5 = this.props,
                onScroll = _props5.onScroll,
                onScrollFrame = _props5.onScrollFrame,
                onScrollStart = _props5.onScrollStart,
                onScrollStop = _props5.onScrollStop,
                onUpdate = _props5.onUpdate,
                renderView = _props5.renderView,
                renderTrackHorizontal = _props5.renderTrackHorizontal,
                renderTrackVertical = _props5.renderTrackVertical,
                renderThumbHorizontal = _props5.renderThumbHorizontal,
                renderThumbVertical = _props5.renderThumbVertical,
                tagName = _props5.tagName,
                hideTracksWhenNotNeeded = _props5.hideTracksWhenNotNeeded,
                autoHide = _props5.autoHide,
                autoHideTimeout = _props5.autoHideTimeout,
                autoHideDuration = _props5.autoHideDuration,
                thumbSize = _props5.thumbSize,
                thumbMinSize = _props5.thumbMinSize,
                universal = _props5.universal,
                autoHeight = _props5.autoHeight,
                autoHeightMin = _props5.autoHeightMin,
                autoHeightMax = _props5.autoHeightMax,
                style = _props5.style,
                children = _props5.children,
                props = _objectWithoutProperties(_props5, ['onScroll', 'onScrollFrame', 'onScrollStart', 'onScrollStop', 'onUpdate', 'renderView', 'renderTrackHorizontal', 'renderTrackVertical', 'renderThumbHorizontal', 'renderThumbVertical', 'tagName', 'hideTracksWhenNotNeeded', 'autoHide', 'autoHideTimeout', 'autoHideDuration', 'thumbSize', 'thumbMinSize', 'universal', 'autoHeight', 'autoHeightMin', 'autoHeightMax', 'style', 'children']);
            /* eslint-enable no-unused-vars */

            var didMountUniversal = this.state.didMountUniversal;


            var containerStyle = _extends({}, _styles.containerStyleDefault, autoHeight && _extends({}, _styles.containerStyleAutoHeight, {
                minHeight: autoHeightMin,
                maxHeight: autoHeightMax
            }), style);

            var viewStyle = _extends({}, _styles.viewStyleDefault, {
                // Hide scrollbars by setting a negative margin
                marginRight: scrollbarWidth ? -scrollbarWidth : 0,
                marginBottom: scrollbarWidth ? -scrollbarWidth : 0
            }, autoHeight && _extends({}, _styles.viewStyleAutoHeight, {
                // Add scrollbarWidth to autoHeight in order to compensate negative margins
                minHeight: (0, _isString2["default"])(autoHeightMin) ? 'calc(' + autoHeightMin + ' + ' + scrollbarWidth + 'px)' : autoHeightMin + scrollbarWidth,
                maxHeight: (0, _isString2["default"])(autoHeightMax) ? 'calc(' + autoHeightMax + ' + ' + scrollbarWidth + 'px)' : autoHeightMax + scrollbarWidth
            }), autoHeight && universal && !didMountUniversal && {
                minHeight: autoHeightMin,
                maxHeight: autoHeightMax
            }, universal && !didMountUniversal && _styles.viewStyleUniversalInitial);

            var trackAutoHeightStyle = {
                transition: 'opacity ' + autoHideDuration + 'ms',
                opacity: 0
            };

            var trackHorizontalStyle = _extends({}, _styles.trackHorizontalStyleDefault, autoHide && trackAutoHeightStyle, (!scrollbarWidth || universal && !didMountUniversal) && {
                display: 'none'
            });

            var trackVerticalStyle = _extends({}, _styles.trackVerticalStyleDefault, autoHide && trackAutoHeightStyle, (!scrollbarWidth || universal && !didMountUniversal) && {
                display: 'none'
            });

            return (0, _react.createElement)(tagName, _extends({}, props, { style: containerStyle, ref: function ref(_ref3) {
                    _this7.container = _ref3;
                } }), [(0, _react.cloneElement)(renderView({ style: viewStyle }), { key: 'view', ref: function ref(_ref4) {
                    _this7.view = _ref4;
                } }, children), (0, _react.cloneElement)(renderTrackHorizontal({ style: trackHorizontalStyle }), { key: 'trackHorizontal', ref: function ref(_ref5) {
                    _this7.trackHorizontal = _ref5;
                } }, (0, _react.cloneElement)(renderThumbHorizontal({ style: _styles.thumbHorizontalStyleDefault }), { ref: function ref(_ref6) {
                    _this7.thumbHorizontal = _ref6;
                } })), (0, _react.cloneElement)(renderTrackVertical({ style: trackVerticalStyle }), { key: 'trackVertical', ref: function ref(_ref7) {
                    _this7.trackVertical = _ref7;
                } }, (0, _react.cloneElement)(renderThumbVertical({ style: _styles.thumbVerticalStyleDefault }), { ref: function ref(_ref8) {
                    _this7.thumbVertical = _ref8;
                } }))]);
        }
    }]);

    return Scrollbars;
}(_react.Component);

exports["default"] = Scrollbars;


Scrollbars.propTypes = {
    onScroll: _propTypes2["default"].func,
    onScrollFrame: _propTypes2["default"].func,
    onScrollStart: _propTypes2["default"].func,
    onScrollStop: _propTypes2["default"].func,
    onUpdate: _propTypes2["default"].func,
    renderView: _propTypes2["default"].func,
    renderTrackHorizontal: _propTypes2["default"].func,
    renderTrackVertical: _propTypes2["default"].func,
    renderThumbHorizontal: _propTypes2["default"].func,
    renderThumbVertical: _propTypes2["default"].func,
    tagName: _propTypes2["default"].string,
    thumbSize: _propTypes2["default"].number,
    thumbMinSize: _propTypes2["default"].number,
    hideTracksWhenNotNeeded: _propTypes2["default"].bool,
    autoHide: _propTypes2["default"].bool,
    autoHideTimeout: _propTypes2["default"].number,
    autoHideDuration: _propTypes2["default"].number,
    autoHeight: _propTypes2["default"].bool,
    autoHeightMin: _propTypes2["default"].oneOfType([_propTypes2["default"].number, _propTypes2["default"].string]),
    autoHeightMax: _propTypes2["default"].oneOfType([_propTypes2["default"].number, _propTypes2["default"].string]),
    universal: _propTypes2["default"].bool,
    style: _propTypes2["default"].object,
    children: _propTypes2["default"].node
};

Scrollbars.defaultProps = {
    renderView: _defaultRenderElements.renderViewDefault,
    renderTrackHorizontal: _defaultRenderElements.renderTrackHorizontalDefault,
    renderTrackVertical: _defaultRenderElements.renderTrackVerticalDefault,
    renderThumbHorizontal: _defaultRenderElements.renderThumbHorizontalDefault,
    renderThumbVertical: _defaultRenderElements.renderThumbVerticalDefault,
    tagName: 'div',
    thumbMinSize: 30,
    hideTracksWhenNotNeeded: false,
    autoHide: false,
    autoHideTimeout: 1000,
    autoHideDuration: 200,
    autoHeight: false,
    autoHeightMin: 0,
    autoHeightMax: 200,
    universal: false
};

/***/ }),

/***/ "./node_modules/react-custom-scrollbars-2/lib/Scrollbars/styles.js":
/*!*************************************************************************!*\
  !*** ./node_modules/react-custom-scrollbars-2/lib/Scrollbars/styles.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, exports) => {



Object.defineProperty(exports, "__esModule", ({
    value: true
}));
var containerStyleDefault = exports.containerStyleDefault = {
    position: 'relative',
    overflow: 'hidden',
    width: '100%',
    height: '100%'
};

// Overrides containerStyleDefault properties
var containerStyleAutoHeight = exports.containerStyleAutoHeight = {
    height: 'auto'
};

var viewStyleDefault = exports.viewStyleDefault = {
    position: 'absolute',
    top: 0,
    left: 0,
    right: 0,
    bottom: 0,
    overflow: 'scroll',
    WebkitOverflowScrolling: 'touch'
};

// Overrides viewStyleDefault properties
var viewStyleAutoHeight = exports.viewStyleAutoHeight = {
    position: 'relative',
    top: undefined,
    left: undefined,
    right: undefined,
    bottom: undefined
};

var viewStyleUniversalInitial = exports.viewStyleUniversalInitial = {
    overflow: 'hidden',
    marginRight: 0,
    marginBottom: 0
};

var trackHorizontalStyleDefault = exports.trackHorizontalStyleDefault = {
    position: 'absolute',
    height: 6
};

var trackVerticalStyleDefault = exports.trackVerticalStyleDefault = {
    position: 'absolute',
    width: 6
};

var thumbHorizontalStyleDefault = exports.thumbHorizontalStyleDefault = {
    position: 'relative',
    display: 'block',
    height: '100%'
};

var thumbVerticalStyleDefault = exports.thumbVerticalStyleDefault = {
    position: 'relative',
    display: 'block',
    width: '100%'
};

var disableSelectStyle = exports.disableSelectStyle = {
    userSelect: 'none'
};

var disableSelectStyleReset = exports.disableSelectStyleReset = {
    userSelect: ''
};

/***/ }),

/***/ "./node_modules/react-custom-scrollbars-2/lib/index.js":
/*!*************************************************************!*\
  !*** ./node_modules/react-custom-scrollbars-2/lib/index.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {



Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports.Scrollbars = undefined;

var _Scrollbars = __webpack_require__(/*! ./Scrollbars */ "./node_modules/react-custom-scrollbars-2/lib/Scrollbars/index.js");

var _Scrollbars2 = _interopRequireDefault(_Scrollbars);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

exports["default"] = _Scrollbars2["default"];
exports.Scrollbars = _Scrollbars2["default"];

/***/ }),

/***/ "./node_modules/react-custom-scrollbars-2/lib/utils/getInnerHeight.js":
/*!****************************************************************************!*\
  !*** ./node_modules/react-custom-scrollbars-2/lib/utils/getInnerHeight.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, exports) => {



Object.defineProperty(exports, "__esModule", ({
    value: true
}));
exports["default"] = getInnerHeight;
function getInnerHeight(el) {
    var clientHeight = el.clientHeight;

    var _getComputedStyle = getComputedStyle(el),
        paddingTop = _getComputedStyle.paddingTop,
        paddingBottom = _getComputedStyle.paddingBottom;

    return clientHeight - parseFloat(paddingTop) - parseFloat(paddingBottom);
}

/***/ }),

/***/ "./node_modules/react-custom-scrollbars-2/lib/utils/getInnerWidth.js":
/*!***************************************************************************!*\
  !*** ./node_modules/react-custom-scrollbars-2/lib/utils/getInnerWidth.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, exports) => {



Object.defineProperty(exports, "__esModule", ({
    value: true
}));
exports["default"] = getInnerWidth;
function getInnerWidth(el) {
    var clientWidth = el.clientWidth;

    var _getComputedStyle = getComputedStyle(el),
        paddingLeft = _getComputedStyle.paddingLeft,
        paddingRight = _getComputedStyle.paddingRight;

    return clientWidth - parseFloat(paddingLeft) - parseFloat(paddingRight);
}

/***/ }),

/***/ "./node_modules/react-custom-scrollbars-2/lib/utils/getScrollbarWidth.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/react-custom-scrollbars-2/lib/utils/getScrollbarWidth.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {



Object.defineProperty(exports, "__esModule", ({
    value: true
}));
exports["default"] = getScrollbarWidth;

var _domCss = __webpack_require__(/*! dom-css */ "./node_modules/dom-css/index.js");

var _domCss2 = _interopRequireDefault(_domCss);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var scrollbarWidth = false;

function getScrollbarWidth() {
    var cacheEnabled = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;

    if (cacheEnabled && scrollbarWidth !== false) return scrollbarWidth;
    /* istanbul ignore else */
    if (typeof document !== 'undefined') {
        var div = document.createElement('div');
        (0, _domCss2["default"])(div, {
            width: 100,
            height: 100,
            position: 'absolute',
            top: -9999,
            overflow: 'scroll',
            MsOverflowStyle: 'scrollbar'
        });
        document.body.appendChild(div);
        scrollbarWidth = div.offsetWidth - div.clientWidth;
        document.body.removeChild(div);
    } else {
        scrollbarWidth = 0;
    }
    return scrollbarWidth || 0;
}

/***/ }),

/***/ "./node_modules/react-custom-scrollbars-2/lib/utils/isString.js":
/*!**********************************************************************!*\
  !*** ./node_modules/react-custom-scrollbars-2/lib/utils/isString.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, exports) => {



Object.defineProperty(exports, "__esModule", ({
    value: true
}));
exports["default"] = isString;
function isString(maybe) {
    return typeof maybe === 'string';
}

/***/ }),

/***/ "./node_modules/react-custom-scrollbars-2/lib/utils/returnFalse.js":
/*!*************************************************************************!*\
  !*** ./node_modules/react-custom-scrollbars-2/lib/utils/returnFalse.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, exports) => {



Object.defineProperty(exports, "__esModule", ({
    value: true
}));
exports["default"] = returnFalse;
function returnFalse() {
    return false;
}

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtY3VzdG9tLXNjcm9sbGJhcnMtMl9saWJfaW5kZXhfanMuYnVuZGxlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFhOztBQUViLDhDQUE2QztBQUM3QztBQUNBLENBQUMsRUFBQzs7QUFFRixvREFBb0QsZ0JBQWdCLHNCQUFzQixPQUFPLDJCQUEyQiwwQkFBMEIseURBQXlELGlDQUFpQzs7QUFFaFAseUJBQXlCO0FBQ3pCLG9DQUFvQztBQUNwQyxrQ0FBa0M7QUFDbEMsb0NBQW9DO0FBQ3BDLGtDQUFrQzs7QUFFbEMsYUFBYSxtQkFBTyxDQUFDLDRDQUFPOztBQUU1Qjs7QUFFQSx1Q0FBdUMsdUNBQXVDOztBQUU5RSwrQ0FBK0MsaUJBQWlCLHFCQUFxQixvQ0FBb0MsNkRBQTZELHNCQUFzQjs7QUFFNU07O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsOERBQThELG1CQUFtQjtBQUNqRjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLDhEQUE4RCxtQkFBbUI7QUFDakY7O0FBRUE7QUFDQTtBQUNBOztBQUVBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsOERBQThELG1CQUFtQjtBQUNqRjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCw4REFBOEQsbUJBQW1CO0FBQ2pGOzs7Ozs7Ozs7O0FDNUVhOztBQUViLDhDQUE2QztBQUM3QztBQUNBLENBQUMsRUFBQzs7QUFFRixvREFBb0QsZ0JBQWdCLHNCQUFzQixPQUFPLDJCQUEyQiwwQkFBMEIseURBQXlELGlDQUFpQzs7QUFFaFAsaUNBQWlDLDJDQUEyQyxnQkFBZ0Isa0JBQWtCLE9BQU8sMkJBQTJCLHdEQUF3RCxnQ0FBZ0MsdURBQXVELCtEQUErRCx5REFBeUQscUVBQXFFLDZEQUE2RCx3QkFBd0I7O0FBRWpqQixZQUFZLG1CQUFPLENBQUMsd0NBQUs7O0FBRXpCOztBQUVBLGNBQWMsbUJBQU8sQ0FBQyxnREFBUzs7QUFFL0I7O0FBRUEsYUFBYSxtQkFBTyxDQUFDLDRDQUFPOztBQUU1QixpQkFBaUIsbUJBQU8sQ0FBQyxzREFBWTs7QUFFckM7O0FBRUEsZ0JBQWdCLG1CQUFPLENBQUMseUZBQW1COztBQUUzQzs7QUFFQSx5QkFBeUIsbUJBQU8sQ0FBQywyR0FBNEI7O0FBRTdEOztBQUVBLG1CQUFtQixtQkFBTyxDQUFDLCtGQUFzQjs7QUFFakQ7O0FBRUEscUJBQXFCLG1CQUFPLENBQUMsbUdBQXdCOztBQUVyRDs7QUFFQSxzQkFBc0IsbUJBQU8sQ0FBQyxxR0FBeUI7O0FBRXZEOztBQUVBLGNBQWMsbUJBQU8sQ0FBQyxtRkFBVTs7QUFFaEMsNkJBQTZCLG1CQUFPLENBQUMsaUhBQXlCOztBQUU5RCx1Q0FBdUMsdUNBQXVDOztBQUU5RSwrQ0FBK0MsaUJBQWlCLHFCQUFxQixvQ0FBb0MsNkRBQTZELHNCQUFzQjs7QUFFNU0sa0RBQWtELDBDQUEwQzs7QUFFNUYsa0RBQWtELGFBQWEseUZBQXlGOztBQUV4SiwyQ0FBMkMsK0RBQStELHVHQUF1Ryx5RUFBeUUsZUFBZSwwRUFBMEUsR0FBRzs7QUFFdFg7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBLDJGQUEyRixhQUFhO0FBQ3hHO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDRCQUE0Qix5QkFBeUI7QUFDckQ7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLHVDQUF1QztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsNkRBQTZELFlBQVk7QUFDekUsMkRBQTJELFlBQVk7QUFDdkU7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxtRUFBbUUsWUFBWTtBQUMvRSxpRUFBaUUsWUFBWTtBQUM3RSxhQUFhO0FBQ2I7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7O0FBR0EsNENBQTRDLDBEQUEwRDtBQUN0RztBQUNBO0FBQ0EsYUFBYTs7QUFFYix1Q0FBdUM7QUFDdkM7QUFDQTtBQUNBO0FBQ0EsYUFBYSwyQkFBMkI7QUFDeEM7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGtEQUFrRDtBQUNsRDtBQUNBLGFBQWE7O0FBRWIsZ0RBQWdEO0FBQ2hEO0FBQ0EsYUFBYTs7QUFFYixpRUFBaUUsV0FBVztBQUM1RTtBQUNBLG1CQUFtQiwwQ0FBMEMsa0JBQWtCLEtBQUs7QUFDcEY7QUFDQSxtQkFBbUIsOERBQThELDZCQUE2QixLQUFLO0FBQ25IO0FBQ0EsbUJBQW1CLG1EQUFtRCw0Q0FBNEMsS0FBSztBQUN2SDtBQUNBLG1CQUFtQixtREFBbUQsMkJBQTJCLEtBQUs7QUFDdEc7QUFDQSxtQkFBbUIsaURBQWlELDBDQUEwQyxLQUFLO0FBQ25IO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0EsS0FBSzs7QUFFTDtBQUNBLENBQUM7O0FBRUQsa0JBQWtCOzs7QUFHbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7OztBQ3p4QmE7O0FBRWIsOENBQTZDO0FBQzdDO0FBQ0EsQ0FBQyxFQUFDO0FBQ0YsNEJBQTRCLDZCQUE2QjtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsK0JBQStCLGdDQUFnQztBQUMvRDtBQUNBOztBQUVBLHVCQUF1Qix3QkFBd0I7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDBCQUEwQiwyQkFBMkI7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGdDQUFnQyxpQ0FBaUM7QUFDakU7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsa0NBQWtDLG1DQUFtQztBQUNyRTtBQUNBO0FBQ0E7O0FBRUEsZ0NBQWdDLGlDQUFpQztBQUNqRTtBQUNBO0FBQ0E7O0FBRUEsa0NBQWtDLG1DQUFtQztBQUNyRTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxnQ0FBZ0MsaUNBQWlDO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHlCQUF5QiwwQkFBMEI7QUFDbkQ7QUFDQTs7QUFFQSw4QkFBOEIsK0JBQStCO0FBQzdEO0FBQ0E7Ozs7Ozs7Ozs7QUN0RWE7O0FBRWIsOENBQTZDO0FBQzdDO0FBQ0EsQ0FBQyxFQUFDO0FBQ0Ysa0JBQWtCOztBQUVsQixrQkFBa0IsbUJBQU8sQ0FBQyxzRkFBYzs7QUFFeEM7O0FBRUEsdUNBQXVDLHVDQUF1Qzs7QUFFOUUsa0JBQWtCO0FBQ2xCLGtCQUFrQjs7Ozs7Ozs7OztBQ2RMOztBQUViLDhDQUE2QztBQUM3QztBQUNBLENBQUMsRUFBQztBQUNGLGtCQUFrQjtBQUNsQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOzs7Ozs7Ozs7O0FDZGE7O0FBRWIsOENBQTZDO0FBQzdDO0FBQ0EsQ0FBQyxFQUFDO0FBQ0Ysa0JBQWtCO0FBQ2xCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7Ozs7Ozs7Ozs7QUNkYTs7QUFFYiw4Q0FBNkM7QUFDN0M7QUFDQSxDQUFDLEVBQUM7QUFDRixrQkFBa0I7O0FBRWxCLGNBQWMsbUJBQU8sQ0FBQyxnREFBUzs7QUFFL0I7O0FBRUEsdUNBQXVDLHVDQUF1Qzs7QUFFOUU7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7OztBQ3JDYTs7QUFFYiw4Q0FBNkM7QUFDN0M7QUFDQSxDQUFDLEVBQUM7QUFDRixrQkFBa0I7QUFDbEI7QUFDQTtBQUNBOzs7Ozs7Ozs7O0FDUmE7O0FBRWIsOENBQTZDO0FBQzdDO0FBQ0EsQ0FBQyxFQUFDO0FBQ0Ysa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2F2YWxhbmNoZS1leHRlbnNpb24vLi9ub2RlX21vZHVsZXMvcmVhY3QtY3VzdG9tLXNjcm9sbGJhcnMtMi9saWIvU2Nyb2xsYmFycy9kZWZhdWx0UmVuZGVyRWxlbWVudHMuanMiLCJ3ZWJwYWNrOi8vYXZhbGFuY2hlLWV4dGVuc2lvbi8uL25vZGVfbW9kdWxlcy9yZWFjdC1jdXN0b20tc2Nyb2xsYmFycy0yL2xpYi9TY3JvbGxiYXJzL2luZGV4LmpzIiwid2VicGFjazovL2F2YWxhbmNoZS1leHRlbnNpb24vLi9ub2RlX21vZHVsZXMvcmVhY3QtY3VzdG9tLXNjcm9sbGJhcnMtMi9saWIvU2Nyb2xsYmFycy9zdHlsZXMuanMiLCJ3ZWJwYWNrOi8vYXZhbGFuY2hlLWV4dGVuc2lvbi8uL25vZGVfbW9kdWxlcy9yZWFjdC1jdXN0b20tc2Nyb2xsYmFycy0yL2xpYi9pbmRleC5qcyIsIndlYnBhY2s6Ly9hdmFsYW5jaGUtZXh0ZW5zaW9uLy4vbm9kZV9tb2R1bGVzL3JlYWN0LWN1c3RvbS1zY3JvbGxiYXJzLTIvbGliL3V0aWxzL2dldElubmVySGVpZ2h0LmpzIiwid2VicGFjazovL2F2YWxhbmNoZS1leHRlbnNpb24vLi9ub2RlX21vZHVsZXMvcmVhY3QtY3VzdG9tLXNjcm9sbGJhcnMtMi9saWIvdXRpbHMvZ2V0SW5uZXJXaWR0aC5qcyIsIndlYnBhY2s6Ly9hdmFsYW5jaGUtZXh0ZW5zaW9uLy4vbm9kZV9tb2R1bGVzL3JlYWN0LWN1c3RvbS1zY3JvbGxiYXJzLTIvbGliL3V0aWxzL2dldFNjcm9sbGJhcldpZHRoLmpzIiwid2VicGFjazovL2F2YWxhbmNoZS1leHRlbnNpb24vLi9ub2RlX21vZHVsZXMvcmVhY3QtY3VzdG9tLXNjcm9sbGJhcnMtMi9saWIvdXRpbHMvaXNTdHJpbmcuanMiLCJ3ZWJwYWNrOi8vYXZhbGFuY2hlLWV4dGVuc2lvbi8uL25vZGVfbW9kdWxlcy9yZWFjdC1jdXN0b20tc2Nyb2xsYmFycy0yL2xpYi91dGlscy9yZXR1cm5GYWxzZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07IGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHsgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsgfSB9IH0gcmV0dXJuIHRhcmdldDsgfTtcblxuZXhwb3J0cy5yZW5kZXJWaWV3RGVmYXVsdCA9IHJlbmRlclZpZXdEZWZhdWx0O1xuZXhwb3J0cy5yZW5kZXJUcmFja0hvcml6b250YWxEZWZhdWx0ID0gcmVuZGVyVHJhY2tIb3Jpem9udGFsRGVmYXVsdDtcbmV4cG9ydHMucmVuZGVyVHJhY2tWZXJ0aWNhbERlZmF1bHQgPSByZW5kZXJUcmFja1ZlcnRpY2FsRGVmYXVsdDtcbmV4cG9ydHMucmVuZGVyVGh1bWJIb3Jpem9udGFsRGVmYXVsdCA9IHJlbmRlclRodW1iSG9yaXpvbnRhbERlZmF1bHQ7XG5leHBvcnRzLnJlbmRlclRodW1iVmVydGljYWxEZWZhdWx0ID0gcmVuZGVyVGh1bWJWZXJ0aWNhbERlZmF1bHQ7XG5cbnZhciBfcmVhY3QgPSByZXF1aXJlKCdyZWFjdCcpO1xuXG52YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgXCJkZWZhdWx0XCI6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhvYmosIGtleXMpIHsgdmFyIHRhcmdldCA9IHt9OyBmb3IgKHZhciBpIGluIG9iaikgeyBpZiAoa2V5cy5pbmRleE9mKGkpID49IDApIGNvbnRpbnVlOyBpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGkpKSBjb250aW51ZTsgdGFyZ2V0W2ldID0gb2JqW2ldOyB9IHJldHVybiB0YXJnZXQ7IH1cblxuLyogZXNsaW50LWRpc2FibGUgcmVhY3QvcHJvcC10eXBlcyAqL1xuXG5mdW5jdGlvbiByZW5kZXJWaWV3RGVmYXVsdChwcm9wcykge1xuICAgIHJldHVybiBfcmVhY3QyW1wiZGVmYXVsdFwiXS5jcmVhdGVFbGVtZW50KCdkaXYnLCBwcm9wcyk7XG59XG5cbmZ1bmN0aW9uIHJlbmRlclRyYWNrSG9yaXpvbnRhbERlZmF1bHQoX3JlZikge1xuICAgIHZhciBzdHlsZSA9IF9yZWYuc3R5bGUsXG4gICAgICAgIHByb3BzID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKF9yZWYsIFsnc3R5bGUnXSk7XG5cbiAgICB2YXIgZmluYWxTdHlsZSA9IF9leHRlbmRzKHt9LCBzdHlsZSwge1xuICAgICAgICByaWdodDogMixcbiAgICAgICAgYm90dG9tOiAyLFxuICAgICAgICBsZWZ0OiAyLFxuICAgICAgICBib3JkZXJSYWRpdXM6IDNcbiAgICB9KTtcbiAgICByZXR1cm4gX3JlYWN0MltcImRlZmF1bHRcIl0uY3JlYXRlRWxlbWVudCgnZGl2JywgX2V4dGVuZHMoeyBzdHlsZTogZmluYWxTdHlsZSB9LCBwcm9wcykpO1xufVxuXG5mdW5jdGlvbiByZW5kZXJUcmFja1ZlcnRpY2FsRGVmYXVsdChfcmVmMikge1xuICAgIHZhciBzdHlsZSA9IF9yZWYyLnN0eWxlLFxuICAgICAgICBwcm9wcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhfcmVmMiwgWydzdHlsZSddKTtcblxuICAgIHZhciBmaW5hbFN0eWxlID0gX2V4dGVuZHMoe30sIHN0eWxlLCB7XG4gICAgICAgIHJpZ2h0OiAyLFxuICAgICAgICBib3R0b206IDIsXG4gICAgICAgIHRvcDogMixcbiAgICAgICAgYm9yZGVyUmFkaXVzOiAzXG4gICAgfSk7XG4gICAgcmV0dXJuIF9yZWFjdDJbXCJkZWZhdWx0XCJdLmNyZWF0ZUVsZW1lbnQoJ2RpdicsIF9leHRlbmRzKHsgc3R5bGU6IGZpbmFsU3R5bGUgfSwgcHJvcHMpKTtcbn1cblxuZnVuY3Rpb24gcmVuZGVyVGh1bWJIb3Jpem9udGFsRGVmYXVsdChfcmVmMykge1xuICAgIHZhciBzdHlsZSA9IF9yZWYzLnN0eWxlLFxuICAgICAgICBwcm9wcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhfcmVmMywgWydzdHlsZSddKTtcblxuICAgIHZhciBmaW5hbFN0eWxlID0gX2V4dGVuZHMoe30sIHN0eWxlLCB7XG4gICAgICAgIGN1cnNvcjogJ3BvaW50ZXInLFxuICAgICAgICBib3JkZXJSYWRpdXM6ICdpbmhlcml0JyxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiAncmdiYSgwLDAsMCwuMiknXG4gICAgfSk7XG4gICAgcmV0dXJuIF9yZWFjdDJbXCJkZWZhdWx0XCJdLmNyZWF0ZUVsZW1lbnQoJ2RpdicsIF9leHRlbmRzKHsgc3R5bGU6IGZpbmFsU3R5bGUgfSwgcHJvcHMpKTtcbn1cblxuZnVuY3Rpb24gcmVuZGVyVGh1bWJWZXJ0aWNhbERlZmF1bHQoX3JlZjQpIHtcbiAgICB2YXIgc3R5bGUgPSBfcmVmNC5zdHlsZSxcbiAgICAgICAgcHJvcHMgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMoX3JlZjQsIFsnc3R5bGUnXSk7XG5cbiAgICB2YXIgZmluYWxTdHlsZSA9IF9leHRlbmRzKHt9LCBzdHlsZSwge1xuICAgICAgICBjdXJzb3I6ICdwb2ludGVyJyxcbiAgICAgICAgYm9yZGVyUmFkaXVzOiAnaW5oZXJpdCcsXG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogJ3JnYmEoMCwwLDAsLjIpJ1xuICAgIH0pO1xuICAgIHJldHVybiBfcmVhY3QyW1wiZGVmYXVsdFwiXS5jcmVhdGVFbGVtZW50KCdkaXYnLCBfZXh0ZW5kcyh7IHN0eWxlOiBmaW5hbFN0eWxlIH0sIHByb3BzKSk7XG59IiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOyBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7IHRhcmdldFtrZXldID0gc291cmNlW2tleV07IH0gfSB9IHJldHVybiB0YXJnZXQ7IH07XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfcmFmMiA9IHJlcXVpcmUoJ3JhZicpO1xuXG52YXIgX3JhZjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yYWYyKTtcblxudmFyIF9kb21Dc3MgPSByZXF1aXJlKCdkb20tY3NzJyk7XG5cbnZhciBfZG9tQ3NzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RvbUNzcyk7XG5cbnZhciBfcmVhY3QgPSByZXF1aXJlKCdyZWFjdCcpO1xuXG52YXIgX3Byb3BUeXBlcyA9IHJlcXVpcmUoJ3Byb3AtdHlwZXMnKTtcblxudmFyIF9wcm9wVHlwZXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcHJvcFR5cGVzKTtcblxudmFyIF9pc1N0cmluZyA9IHJlcXVpcmUoJy4uL3V0aWxzL2lzU3RyaW5nJyk7XG5cbnZhciBfaXNTdHJpbmcyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaXNTdHJpbmcpO1xuXG52YXIgX2dldFNjcm9sbGJhcldpZHRoID0gcmVxdWlyZSgnLi4vdXRpbHMvZ2V0U2Nyb2xsYmFyV2lkdGgnKTtcblxudmFyIF9nZXRTY3JvbGxiYXJXaWR0aDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRTY3JvbGxiYXJXaWR0aCk7XG5cbnZhciBfcmV0dXJuRmFsc2UgPSByZXF1aXJlKCcuLi91dGlscy9yZXR1cm5GYWxzZScpO1xuXG52YXIgX3JldHVybkZhbHNlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JldHVybkZhbHNlKTtcblxudmFyIF9nZXRJbm5lcldpZHRoID0gcmVxdWlyZSgnLi4vdXRpbHMvZ2V0SW5uZXJXaWR0aCcpO1xuXG52YXIgX2dldElubmVyV2lkdGgyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0SW5uZXJXaWR0aCk7XG5cbnZhciBfZ2V0SW5uZXJIZWlnaHQgPSByZXF1aXJlKCcuLi91dGlscy9nZXRJbm5lckhlaWdodCcpO1xuXG52YXIgX2dldElubmVySGVpZ2h0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldElubmVySGVpZ2h0KTtcblxudmFyIF9zdHlsZXMgPSByZXF1aXJlKCcuL3N0eWxlcycpO1xuXG52YXIgX2RlZmF1bHRSZW5kZXJFbGVtZW50cyA9IHJlcXVpcmUoJy4vZGVmYXVsdFJlbmRlckVsZW1lbnRzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IFwiZGVmYXVsdFwiOiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMob2JqLCBrZXlzKSB7IHZhciB0YXJnZXQgPSB7fTsgZm9yICh2YXIgaSBpbiBvYmopIHsgaWYgKGtleXMuaW5kZXhPZihpKSA+PSAwKSBjb250aW51ZTsgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBpKSkgY29udGludWU7IHRhcmdldFtpXSA9IG9ialtpXTsgfSByZXR1cm4gdGFyZ2V0OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxudmFyIFNjcm9sbGJhcnMgPSBmdW5jdGlvbiAoX0NvbXBvbmVudCkge1xuICAgIF9pbmhlcml0cyhTY3JvbGxiYXJzLCBfQ29tcG9uZW50KTtcblxuICAgIGZ1bmN0aW9uIFNjcm9sbGJhcnMocHJvcHMpIHtcbiAgICAgICAgdmFyIF9yZWY7XG5cbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNjcm9sbGJhcnMpO1xuXG4gICAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCByZXN0ID0gQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgICAgICAgcmVzdFtfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoX3JlZiA9IFNjcm9sbGJhcnMuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihTY3JvbGxiYXJzKSkuY2FsbC5hcHBseShfcmVmLCBbdGhpcywgcHJvcHNdLmNvbmNhdChyZXN0KSkpO1xuXG4gICAgICAgIF90aGlzLmdldFNjcm9sbExlZnQgPSBfdGhpcy5nZXRTY3JvbGxMZWZ0LmJpbmQoX3RoaXMpO1xuICAgICAgICBfdGhpcy5nZXRTY3JvbGxUb3AgPSBfdGhpcy5nZXRTY3JvbGxUb3AuYmluZChfdGhpcyk7XG4gICAgICAgIF90aGlzLmdldFNjcm9sbFdpZHRoID0gX3RoaXMuZ2V0U2Nyb2xsV2lkdGguYmluZChfdGhpcyk7XG4gICAgICAgIF90aGlzLmdldFNjcm9sbEhlaWdodCA9IF90aGlzLmdldFNjcm9sbEhlaWdodC5iaW5kKF90aGlzKTtcbiAgICAgICAgX3RoaXMuZ2V0Q2xpZW50V2lkdGggPSBfdGhpcy5nZXRDbGllbnRXaWR0aC5iaW5kKF90aGlzKTtcbiAgICAgICAgX3RoaXMuZ2V0Q2xpZW50SGVpZ2h0ID0gX3RoaXMuZ2V0Q2xpZW50SGVpZ2h0LmJpbmQoX3RoaXMpO1xuICAgICAgICBfdGhpcy5nZXRWYWx1ZXMgPSBfdGhpcy5nZXRWYWx1ZXMuYmluZChfdGhpcyk7XG4gICAgICAgIF90aGlzLmdldFRodW1iSG9yaXpvbnRhbFdpZHRoID0gX3RoaXMuZ2V0VGh1bWJIb3Jpem9udGFsV2lkdGguYmluZChfdGhpcyk7XG4gICAgICAgIF90aGlzLmdldFRodW1iVmVydGljYWxIZWlnaHQgPSBfdGhpcy5nZXRUaHVtYlZlcnRpY2FsSGVpZ2h0LmJpbmQoX3RoaXMpO1xuICAgICAgICBfdGhpcy5nZXRTY3JvbGxMZWZ0Rm9yT2Zmc2V0ID0gX3RoaXMuZ2V0U2Nyb2xsTGVmdEZvck9mZnNldC5iaW5kKF90aGlzKTtcbiAgICAgICAgX3RoaXMuZ2V0U2Nyb2xsVG9wRm9yT2Zmc2V0ID0gX3RoaXMuZ2V0U2Nyb2xsVG9wRm9yT2Zmc2V0LmJpbmQoX3RoaXMpO1xuXG4gICAgICAgIF90aGlzLnNjcm9sbExlZnQgPSBfdGhpcy5zY3JvbGxMZWZ0LmJpbmQoX3RoaXMpO1xuICAgICAgICBfdGhpcy5zY3JvbGxUb3AgPSBfdGhpcy5zY3JvbGxUb3AuYmluZChfdGhpcyk7XG4gICAgICAgIF90aGlzLnNjcm9sbFRvTGVmdCA9IF90aGlzLnNjcm9sbFRvTGVmdC5iaW5kKF90aGlzKTtcbiAgICAgICAgX3RoaXMuc2Nyb2xsVG9Ub3AgPSBfdGhpcy5zY3JvbGxUb1RvcC5iaW5kKF90aGlzKTtcbiAgICAgICAgX3RoaXMuc2Nyb2xsVG9SaWdodCA9IF90aGlzLnNjcm9sbFRvUmlnaHQuYmluZChfdGhpcyk7XG4gICAgICAgIF90aGlzLnNjcm9sbFRvQm90dG9tID0gX3RoaXMuc2Nyb2xsVG9Cb3R0b20uYmluZChfdGhpcyk7XG5cbiAgICAgICAgX3RoaXMuaGFuZGxlVHJhY2tNb3VzZUVudGVyID0gX3RoaXMuaGFuZGxlVHJhY2tNb3VzZUVudGVyLmJpbmQoX3RoaXMpO1xuICAgICAgICBfdGhpcy5oYW5kbGVUcmFja01vdXNlTGVhdmUgPSBfdGhpcy5oYW5kbGVUcmFja01vdXNlTGVhdmUuYmluZChfdGhpcyk7XG4gICAgICAgIF90aGlzLmhhbmRsZUhvcml6b250YWxUcmFja01vdXNlRG93biA9IF90aGlzLmhhbmRsZUhvcml6b250YWxUcmFja01vdXNlRG93bi5iaW5kKF90aGlzKTtcbiAgICAgICAgX3RoaXMuaGFuZGxlVmVydGljYWxUcmFja01vdXNlRG93biA9IF90aGlzLmhhbmRsZVZlcnRpY2FsVHJhY2tNb3VzZURvd24uYmluZChfdGhpcyk7XG4gICAgICAgIF90aGlzLmhhbmRsZUhvcml6b250YWxUaHVtYk1vdXNlRG93biA9IF90aGlzLmhhbmRsZUhvcml6b250YWxUaHVtYk1vdXNlRG93bi5iaW5kKF90aGlzKTtcbiAgICAgICAgX3RoaXMuaGFuZGxlVmVydGljYWxUaHVtYk1vdXNlRG93biA9IF90aGlzLmhhbmRsZVZlcnRpY2FsVGh1bWJNb3VzZURvd24uYmluZChfdGhpcyk7XG4gICAgICAgIF90aGlzLmhhbmRsZVdpbmRvd1Jlc2l6ZSA9IF90aGlzLmhhbmRsZVdpbmRvd1Jlc2l6ZS5iaW5kKF90aGlzKTtcbiAgICAgICAgX3RoaXMuaGFuZGxlU2Nyb2xsID0gX3RoaXMuaGFuZGxlU2Nyb2xsLmJpbmQoX3RoaXMpO1xuICAgICAgICBfdGhpcy5oYW5kbGVEcmFnID0gX3RoaXMuaGFuZGxlRHJhZy5iaW5kKF90aGlzKTtcbiAgICAgICAgX3RoaXMuaGFuZGxlRHJhZ0VuZCA9IF90aGlzLmhhbmRsZURyYWdFbmQuYmluZChfdGhpcyk7XG5cbiAgICAgICAgX3RoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBkaWRNb3VudFVuaXZlcnNhbDogZmFsc2VcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhTY3JvbGxiYXJzLCBbe1xuICAgICAgICBrZXk6ICdjb21wb25lbnREaWRNb3VudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkTGlzdGVuZXJzKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgICAgICAgICAgdGhpcy5jb21wb25lbnREaWRNb3VudFVuaXZlcnNhbCgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdjb21wb25lbnREaWRNb3VudFVuaXZlcnNhbCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudFVuaXZlcnNhbCgpIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgcmVhY3Qvc29ydC1jb21wXG4gICAgICAgICAgICB2YXIgdW5pdmVyc2FsID0gdGhpcy5wcm9wcy51bml2ZXJzYWw7XG5cbiAgICAgICAgICAgIGlmICghdW5pdmVyc2FsKSByZXR1cm47XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgZGlkTW91bnRVbml2ZXJzYWw6IHRydWUgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2NvbXBvbmVudERpZFVwZGF0ZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRVcGRhdGUoKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdjb21wb25lbnRXaWxsVW5tb3VudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXJzKCk7XG4gICAgICAgICAgICAoMCwgX3JhZjIuY2FuY2VsKSh0aGlzLnJlcXVlc3RGcmFtZSk7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5oaWRlVHJhY2tzVGltZW91dCk7XG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuZGV0ZWN0U2Nyb2xsaW5nSW50ZXJ2YWwpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdnZXRTY3JvbGxMZWZ0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFNjcm9sbExlZnQoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMudmlldykgcmV0dXJuIDA7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy52aWV3LnNjcm9sbExlZnQ7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2dldFNjcm9sbFRvcCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTY3JvbGxUb3AoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMudmlldykgcmV0dXJuIDA7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy52aWV3LnNjcm9sbFRvcDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZ2V0U2Nyb2xsV2lkdGgnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U2Nyb2xsV2lkdGgoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMudmlldykgcmV0dXJuIDA7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy52aWV3LnNjcm9sbFdpZHRoO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdnZXRTY3JvbGxIZWlnaHQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U2Nyb2xsSGVpZ2h0KCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnZpZXcpIHJldHVybiAwO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudmlldy5zY3JvbGxIZWlnaHQ7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2dldENsaWVudFdpZHRoJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENsaWVudFdpZHRoKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnZpZXcpIHJldHVybiAwO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudmlldy5jbGllbnRXaWR0aDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZ2V0Q2xpZW50SGVpZ2h0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENsaWVudEhlaWdodCgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy52aWV3KSByZXR1cm4gMDtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnZpZXcuY2xpZW50SGVpZ2h0O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdnZXRWYWx1ZXMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0VmFsdWVzKCkge1xuICAgICAgICAgICAgdmFyIF9yZWYyID0gdGhpcy52aWV3IHx8IHt9LFxuICAgICAgICAgICAgICAgIF9yZWYyJHNjcm9sbExlZnQgPSBfcmVmMi5zY3JvbGxMZWZ0LFxuICAgICAgICAgICAgICAgIHNjcm9sbExlZnQgPSBfcmVmMiRzY3JvbGxMZWZ0ID09PSB1bmRlZmluZWQgPyAwIDogX3JlZjIkc2Nyb2xsTGVmdCxcbiAgICAgICAgICAgICAgICBfcmVmMiRzY3JvbGxUb3AgPSBfcmVmMi5zY3JvbGxUb3AsXG4gICAgICAgICAgICAgICAgc2Nyb2xsVG9wID0gX3JlZjIkc2Nyb2xsVG9wID09PSB1bmRlZmluZWQgPyAwIDogX3JlZjIkc2Nyb2xsVG9wLFxuICAgICAgICAgICAgICAgIF9yZWYyJHNjcm9sbFdpZHRoID0gX3JlZjIuc2Nyb2xsV2lkdGgsXG4gICAgICAgICAgICAgICAgc2Nyb2xsV2lkdGggPSBfcmVmMiRzY3JvbGxXaWR0aCA9PT0gdW5kZWZpbmVkID8gMCA6IF9yZWYyJHNjcm9sbFdpZHRoLFxuICAgICAgICAgICAgICAgIF9yZWYyJHNjcm9sbEhlaWdodCA9IF9yZWYyLnNjcm9sbEhlaWdodCxcbiAgICAgICAgICAgICAgICBzY3JvbGxIZWlnaHQgPSBfcmVmMiRzY3JvbGxIZWlnaHQgPT09IHVuZGVmaW5lZCA/IDAgOiBfcmVmMiRzY3JvbGxIZWlnaHQsXG4gICAgICAgICAgICAgICAgX3JlZjIkY2xpZW50V2lkdGggPSBfcmVmMi5jbGllbnRXaWR0aCxcbiAgICAgICAgICAgICAgICBjbGllbnRXaWR0aCA9IF9yZWYyJGNsaWVudFdpZHRoID09PSB1bmRlZmluZWQgPyAwIDogX3JlZjIkY2xpZW50V2lkdGgsXG4gICAgICAgICAgICAgICAgX3JlZjIkY2xpZW50SGVpZ2h0ID0gX3JlZjIuY2xpZW50SGVpZ2h0LFxuICAgICAgICAgICAgICAgIGNsaWVudEhlaWdodCA9IF9yZWYyJGNsaWVudEhlaWdodCA9PT0gdW5kZWZpbmVkID8gMCA6IF9yZWYyJGNsaWVudEhlaWdodDtcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBsZWZ0OiBzY3JvbGxMZWZ0IC8gKHNjcm9sbFdpZHRoIC0gY2xpZW50V2lkdGgpIHx8IDAsXG4gICAgICAgICAgICAgICAgdG9wOiBzY3JvbGxUb3AgLyAoc2Nyb2xsSGVpZ2h0IC0gY2xpZW50SGVpZ2h0KSB8fCAwLFxuICAgICAgICAgICAgICAgIHNjcm9sbExlZnQ6IHNjcm9sbExlZnQsXG4gICAgICAgICAgICAgICAgc2Nyb2xsVG9wOiBzY3JvbGxUb3AsXG4gICAgICAgICAgICAgICAgc2Nyb2xsV2lkdGg6IHNjcm9sbFdpZHRoLFxuICAgICAgICAgICAgICAgIHNjcm9sbEhlaWdodDogc2Nyb2xsSGVpZ2h0LFxuICAgICAgICAgICAgICAgIGNsaWVudFdpZHRoOiBjbGllbnRXaWR0aCxcbiAgICAgICAgICAgICAgICBjbGllbnRIZWlnaHQ6IGNsaWVudEhlaWdodFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZ2V0VGh1bWJIb3Jpem9udGFsV2lkdGgnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0VGh1bWJIb3Jpem9udGFsV2lkdGgoKSB7XG4gICAgICAgICAgICB2YXIgX3Byb3BzID0gdGhpcy5wcm9wcyxcbiAgICAgICAgICAgICAgICB0aHVtYlNpemUgPSBfcHJvcHMudGh1bWJTaXplLFxuICAgICAgICAgICAgICAgIHRodW1iTWluU2l6ZSA9IF9wcm9wcy50aHVtYk1pblNpemU7XG4gICAgICAgICAgICB2YXIgX3ZpZXcgPSB0aGlzLnZpZXcsXG4gICAgICAgICAgICAgICAgc2Nyb2xsV2lkdGggPSBfdmlldy5zY3JvbGxXaWR0aCxcbiAgICAgICAgICAgICAgICBjbGllbnRXaWR0aCA9IF92aWV3LmNsaWVudFdpZHRoO1xuXG4gICAgICAgICAgICB2YXIgdHJhY2tXaWR0aCA9ICgwLCBfZ2V0SW5uZXJXaWR0aDJbXCJkZWZhdWx0XCJdKSh0aGlzLnRyYWNrSG9yaXpvbnRhbCk7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSBNYXRoLmNlaWwoY2xpZW50V2lkdGggLyBzY3JvbGxXaWR0aCAqIHRyYWNrV2lkdGgpO1xuICAgICAgICAgICAgaWYgKHRyYWNrV2lkdGggPD0gd2lkdGgpIHJldHVybiAwO1xuICAgICAgICAgICAgaWYgKHRodW1iU2l6ZSkgcmV0dXJuIHRodW1iU2l6ZTtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLm1heCh3aWR0aCwgdGh1bWJNaW5TaXplKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZ2V0VGh1bWJWZXJ0aWNhbEhlaWdodCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRUaHVtYlZlcnRpY2FsSGVpZ2h0KCkge1xuICAgICAgICAgICAgdmFyIF9wcm9wczIgPSB0aGlzLnByb3BzLFxuICAgICAgICAgICAgICAgIHRodW1iU2l6ZSA9IF9wcm9wczIudGh1bWJTaXplLFxuICAgICAgICAgICAgICAgIHRodW1iTWluU2l6ZSA9IF9wcm9wczIudGh1bWJNaW5TaXplO1xuICAgICAgICAgICAgdmFyIF92aWV3MiA9IHRoaXMudmlldyxcbiAgICAgICAgICAgICAgICBzY3JvbGxIZWlnaHQgPSBfdmlldzIuc2Nyb2xsSGVpZ2h0LFxuICAgICAgICAgICAgICAgIGNsaWVudEhlaWdodCA9IF92aWV3Mi5jbGllbnRIZWlnaHQ7XG5cbiAgICAgICAgICAgIHZhciB0cmFja0hlaWdodCA9ICgwLCBfZ2V0SW5uZXJIZWlnaHQyW1wiZGVmYXVsdFwiXSkodGhpcy50cmFja1ZlcnRpY2FsKTtcbiAgICAgICAgICAgIHZhciBoZWlnaHQgPSBNYXRoLmNlaWwoY2xpZW50SGVpZ2h0IC8gc2Nyb2xsSGVpZ2h0ICogdHJhY2tIZWlnaHQpO1xuICAgICAgICAgICAgaWYgKHRyYWNrSGVpZ2h0IDw9IGhlaWdodCkgcmV0dXJuIDA7XG4gICAgICAgICAgICBpZiAodGh1bWJTaXplKSByZXR1cm4gdGh1bWJTaXplO1xuICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KGhlaWdodCwgdGh1bWJNaW5TaXplKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZ2V0U2Nyb2xsTGVmdEZvck9mZnNldCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTY3JvbGxMZWZ0Rm9yT2Zmc2V0KG9mZnNldCkge1xuICAgICAgICAgICAgdmFyIF92aWV3MyA9IHRoaXMudmlldyxcbiAgICAgICAgICAgICAgICBzY3JvbGxXaWR0aCA9IF92aWV3My5zY3JvbGxXaWR0aCxcbiAgICAgICAgICAgICAgICBjbGllbnRXaWR0aCA9IF92aWV3My5jbGllbnRXaWR0aDtcblxuICAgICAgICAgICAgdmFyIHRyYWNrV2lkdGggPSAoMCwgX2dldElubmVyV2lkdGgyW1wiZGVmYXVsdFwiXSkodGhpcy50cmFja0hvcml6b250YWwpO1xuICAgICAgICAgICAgdmFyIHRodW1iV2lkdGggPSB0aGlzLmdldFRodW1iSG9yaXpvbnRhbFdpZHRoKCk7XG4gICAgICAgICAgICByZXR1cm4gb2Zmc2V0IC8gKHRyYWNrV2lkdGggLSB0aHVtYldpZHRoKSAqIChzY3JvbGxXaWR0aCAtIGNsaWVudFdpZHRoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZ2V0U2Nyb2xsVG9wRm9yT2Zmc2V0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFNjcm9sbFRvcEZvck9mZnNldChvZmZzZXQpIHtcbiAgICAgICAgICAgIHZhciBfdmlldzQgPSB0aGlzLnZpZXcsXG4gICAgICAgICAgICAgICAgc2Nyb2xsSGVpZ2h0ID0gX3ZpZXc0LnNjcm9sbEhlaWdodCxcbiAgICAgICAgICAgICAgICBjbGllbnRIZWlnaHQgPSBfdmlldzQuY2xpZW50SGVpZ2h0O1xuXG4gICAgICAgICAgICB2YXIgdHJhY2tIZWlnaHQgPSAoMCwgX2dldElubmVySGVpZ2h0MltcImRlZmF1bHRcIl0pKHRoaXMudHJhY2tWZXJ0aWNhbCk7XG4gICAgICAgICAgICB2YXIgdGh1bWJIZWlnaHQgPSB0aGlzLmdldFRodW1iVmVydGljYWxIZWlnaHQoKTtcbiAgICAgICAgICAgIHJldHVybiBvZmZzZXQgLyAodHJhY2tIZWlnaHQgLSB0aHVtYkhlaWdodCkgKiAoc2Nyb2xsSGVpZ2h0IC0gY2xpZW50SGVpZ2h0KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc2Nyb2xsTGVmdCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzY3JvbGxMZWZ0KCkge1xuICAgICAgICAgICAgdmFyIGxlZnQgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IDA7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy52aWV3KSByZXR1cm47XG4gICAgICAgICAgICB0aGlzLnZpZXcuc2Nyb2xsTGVmdCA9IGxlZnQ7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3Njcm9sbFRvcCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzY3JvbGxUb3AoKSB7XG4gICAgICAgICAgICB2YXIgdG9wID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAwO1xuXG4gICAgICAgICAgICBpZiAoIXRoaXMudmlldykgcmV0dXJuO1xuICAgICAgICAgICAgdGhpcy52aWV3LnNjcm9sbFRvcCA9IHRvcDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc2Nyb2xsVG9MZWZ0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNjcm9sbFRvTGVmdCgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy52aWV3KSByZXR1cm47XG4gICAgICAgICAgICB0aGlzLnZpZXcuc2Nyb2xsTGVmdCA9IDA7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3Njcm9sbFRvVG9wJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNjcm9sbFRvVG9wKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnZpZXcpIHJldHVybjtcbiAgICAgICAgICAgIHRoaXMudmlldy5zY3JvbGxUb3AgPSAwO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzY3JvbGxUb1JpZ2h0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNjcm9sbFRvUmlnaHQoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMudmlldykgcmV0dXJuO1xuICAgICAgICAgICAgdGhpcy52aWV3LnNjcm9sbExlZnQgPSB0aGlzLnZpZXcuc2Nyb2xsV2lkdGg7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3Njcm9sbFRvQm90dG9tJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNjcm9sbFRvQm90dG9tKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnZpZXcpIHJldHVybjtcbiAgICAgICAgICAgIHRoaXMudmlldy5zY3JvbGxUb3AgPSB0aGlzLnZpZXcuc2Nyb2xsSGVpZ2h0O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdhZGRMaXN0ZW5lcnMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWRkTGlzdGVuZXJzKCkge1xuICAgICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovXG4gICAgICAgICAgICBpZiAodHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJyB8fCAhdGhpcy52aWV3KSByZXR1cm47XG4gICAgICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlldyxcbiAgICAgICAgICAgICAgICB0cmFja0hvcml6b250YWwgPSB0aGlzLnRyYWNrSG9yaXpvbnRhbCxcbiAgICAgICAgICAgICAgICB0cmFja1ZlcnRpY2FsID0gdGhpcy50cmFja1ZlcnRpY2FsLFxuICAgICAgICAgICAgICAgIHRodW1iSG9yaXpvbnRhbCA9IHRoaXMudGh1bWJIb3Jpem9udGFsLFxuICAgICAgICAgICAgICAgIHRodW1iVmVydGljYWwgPSB0aGlzLnRodW1iVmVydGljYWw7XG5cbiAgICAgICAgICAgIHZpZXcuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5oYW5kbGVTY3JvbGwpO1xuICAgICAgICAgICAgaWYgKCEoMCwgX2dldFNjcm9sbGJhcldpZHRoMltcImRlZmF1bHRcIl0pKCkpIHJldHVybjtcbiAgICAgICAgICAgIHRyYWNrSG9yaXpvbnRhbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgdGhpcy5oYW5kbGVUcmFja01vdXNlRW50ZXIpO1xuICAgICAgICAgICAgdHJhY2tIb3Jpem9udGFsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCB0aGlzLmhhbmRsZVRyYWNrTW91c2VMZWF2ZSk7XG4gICAgICAgICAgICB0cmFja0hvcml6b250YWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5oYW5kbGVIb3Jpem9udGFsVHJhY2tNb3VzZURvd24pO1xuICAgICAgICAgICAgdHJhY2tWZXJ0aWNhbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgdGhpcy5oYW5kbGVUcmFja01vdXNlRW50ZXIpO1xuICAgICAgICAgICAgdHJhY2tWZXJ0aWNhbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgdGhpcy5oYW5kbGVUcmFja01vdXNlTGVhdmUpO1xuICAgICAgICAgICAgdHJhY2tWZXJ0aWNhbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLmhhbmRsZVZlcnRpY2FsVHJhY2tNb3VzZURvd24pO1xuICAgICAgICAgICAgdGh1bWJIb3Jpem9udGFsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuaGFuZGxlSG9yaXpvbnRhbFRodW1iTW91c2VEb3duKTtcbiAgICAgICAgICAgIHRodW1iVmVydGljYWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5oYW5kbGVWZXJ0aWNhbFRodW1iTW91c2VEb3duKTtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLmhhbmRsZVdpbmRvd1Jlc2l6ZSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3JlbW92ZUxpc3RlbmVycycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVMaXN0ZW5lcnMoKSB7XG4gICAgICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi9cbiAgICAgICAgICAgIGlmICh0eXBlb2YgZG9jdW1lbnQgPT09ICd1bmRlZmluZWQnIHx8ICF0aGlzLnZpZXcpIHJldHVybjtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3LFxuICAgICAgICAgICAgICAgIHRyYWNrSG9yaXpvbnRhbCA9IHRoaXMudHJhY2tIb3Jpem9udGFsLFxuICAgICAgICAgICAgICAgIHRyYWNrVmVydGljYWwgPSB0aGlzLnRyYWNrVmVydGljYWwsXG4gICAgICAgICAgICAgICAgdGh1bWJIb3Jpem9udGFsID0gdGhpcy50aHVtYkhvcml6b250YWwsXG4gICAgICAgICAgICAgICAgdGh1bWJWZXJ0aWNhbCA9IHRoaXMudGh1bWJWZXJ0aWNhbDtcblxuICAgICAgICAgICAgdmlldy5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLmhhbmRsZVNjcm9sbCk7XG4gICAgICAgICAgICBpZiAoISgwLCBfZ2V0U2Nyb2xsYmFyV2lkdGgyW1wiZGVmYXVsdFwiXSkoKSkgcmV0dXJuO1xuICAgICAgICAgICAgdHJhY2tIb3Jpem9udGFsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCB0aGlzLmhhbmRsZVRyYWNrTW91c2VFbnRlcik7XG4gICAgICAgICAgICB0cmFja0hvcml6b250YWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIHRoaXMuaGFuZGxlVHJhY2tNb3VzZUxlYXZlKTtcbiAgICAgICAgICAgIHRyYWNrSG9yaXpvbnRhbC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLmhhbmRsZUhvcml6b250YWxUcmFja01vdXNlRG93bik7XG4gICAgICAgICAgICB0cmFja1ZlcnRpY2FsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCB0aGlzLmhhbmRsZVRyYWNrTW91c2VFbnRlcik7XG4gICAgICAgICAgICB0cmFja1ZlcnRpY2FsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCB0aGlzLmhhbmRsZVRyYWNrTW91c2VMZWF2ZSk7XG4gICAgICAgICAgICB0cmFja1ZlcnRpY2FsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuaGFuZGxlVmVydGljYWxUcmFja01vdXNlRG93bik7XG4gICAgICAgICAgICB0aHVtYkhvcml6b250YWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5oYW5kbGVIb3Jpem9udGFsVGh1bWJNb3VzZURvd24pO1xuICAgICAgICAgICAgdGh1bWJWZXJ0aWNhbC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLmhhbmRsZVZlcnRpY2FsVGh1bWJNb3VzZURvd24pO1xuICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMuaGFuZGxlV2luZG93UmVzaXplKTtcbiAgICAgICAgICAgIC8vIFBvc3NpYmx5IHNldHVwIGJ5IGBoYW5kbGVEcmFnU3RhcnRgXG4gICAgICAgICAgICB0aGlzLnRlYXJkb3duRHJhZ2dpbmcoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnaGFuZGxlU2Nyb2xsJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZVNjcm9sbChldmVudCkge1xuICAgICAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHZhciBfcHJvcHMzID0gdGhpcy5wcm9wcyxcbiAgICAgICAgICAgICAgICBvblNjcm9sbCA9IF9wcm9wczMub25TY3JvbGwsXG4gICAgICAgICAgICAgICAgb25TY3JvbGxGcmFtZSA9IF9wcm9wczMub25TY3JvbGxGcmFtZTtcblxuICAgICAgICAgICAgaWYgKG9uU2Nyb2xsKSBvblNjcm9sbChldmVudCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZShmdW5jdGlvbiAodmFsdWVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNjcm9sbExlZnQgPSB2YWx1ZXMuc2Nyb2xsTGVmdCxcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9wID0gdmFsdWVzLnNjcm9sbFRvcDtcblxuICAgICAgICAgICAgICAgIF90aGlzMi52aWV3U2Nyb2xsTGVmdCA9IHNjcm9sbExlZnQ7XG4gICAgICAgICAgICAgICAgX3RoaXMyLnZpZXdTY3JvbGxUb3AgPSBzY3JvbGxUb3A7XG4gICAgICAgICAgICAgICAgaWYgKG9uU2Nyb2xsRnJhbWUpIG9uU2Nyb2xsRnJhbWUodmFsdWVzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5kZXRlY3RTY3JvbGxpbmcoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnaGFuZGxlU2Nyb2xsU3RhcnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlU2Nyb2xsU3RhcnQoKSB7XG4gICAgICAgICAgICB2YXIgb25TY3JvbGxTdGFydCA9IHRoaXMucHJvcHMub25TY3JvbGxTdGFydDtcblxuICAgICAgICAgICAgaWYgKG9uU2Nyb2xsU3RhcnQpIG9uU2Nyb2xsU3RhcnQoKTtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlU2Nyb2xsU3RhcnRBdXRvSGlkZSgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdoYW5kbGVTY3JvbGxTdGFydEF1dG9IaWRlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZVNjcm9sbFN0YXJ0QXV0b0hpZGUoKSB7XG4gICAgICAgICAgICB2YXIgYXV0b0hpZGUgPSB0aGlzLnByb3BzLmF1dG9IaWRlO1xuXG4gICAgICAgICAgICBpZiAoIWF1dG9IaWRlKSByZXR1cm47XG4gICAgICAgICAgICB0aGlzLnNob3dUcmFja3MoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnaGFuZGxlU2Nyb2xsU3RvcCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGVTY3JvbGxTdG9wKCkge1xuICAgICAgICAgICAgdmFyIG9uU2Nyb2xsU3RvcCA9IHRoaXMucHJvcHMub25TY3JvbGxTdG9wO1xuXG4gICAgICAgICAgICBpZiAob25TY3JvbGxTdG9wKSBvblNjcm9sbFN0b3AoKTtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlU2Nyb2xsU3RvcEF1dG9IaWRlKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2hhbmRsZVNjcm9sbFN0b3BBdXRvSGlkZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGVTY3JvbGxTdG9wQXV0b0hpZGUoKSB7XG4gICAgICAgICAgICB2YXIgYXV0b0hpZGUgPSB0aGlzLnByb3BzLmF1dG9IaWRlO1xuXG4gICAgICAgICAgICBpZiAoIWF1dG9IaWRlKSByZXR1cm47XG4gICAgICAgICAgICB0aGlzLmhpZGVUcmFja3MoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnaGFuZGxlV2luZG93UmVzaXplJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZVdpbmRvd1Jlc2l6ZSgpIHtcbiAgICAgICAgICAgICgwLCBfZ2V0U2Nyb2xsYmFyV2lkdGgyW1wiZGVmYXVsdFwiXSkoZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy5mb3JjZVVwZGF0ZSgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdoYW5kbGVIb3Jpem9udGFsVHJhY2tNb3VzZURvd24nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlSG9yaXpvbnRhbFRyYWNrTW91c2VEb3duKGV2ZW50KSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldCxcbiAgICAgICAgICAgICAgICBjbGllbnRYID0gZXZlbnQuY2xpZW50WDtcblxuICAgICAgICAgICAgdmFyIF90YXJnZXQkZ2V0Qm91bmRpbmdDbCA9IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgICAgICAgICB0YXJnZXRMZWZ0ID0gX3RhcmdldCRnZXRCb3VuZGluZ0NsLmxlZnQ7XG5cbiAgICAgICAgICAgIHZhciB0aHVtYldpZHRoID0gdGhpcy5nZXRUaHVtYkhvcml6b250YWxXaWR0aCgpO1xuICAgICAgICAgICAgdmFyIG9mZnNldCA9IE1hdGguYWJzKHRhcmdldExlZnQgLSBjbGllbnRYKSAtIHRodW1iV2lkdGggLyAyO1xuICAgICAgICAgICAgdGhpcy52aWV3LnNjcm9sbExlZnQgPSB0aGlzLmdldFNjcm9sbExlZnRGb3JPZmZzZXQob2Zmc2V0KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnaGFuZGxlVmVydGljYWxUcmFja01vdXNlRG93bicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGVWZXJ0aWNhbFRyYWNrTW91c2VEb3duKGV2ZW50KSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldCxcbiAgICAgICAgICAgICAgICBjbGllbnRZID0gZXZlbnQuY2xpZW50WTtcblxuICAgICAgICAgICAgdmFyIF90YXJnZXQkZ2V0Qm91bmRpbmdDbDIgPSB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgICAgICAgICAgdGFyZ2V0VG9wID0gX3RhcmdldCRnZXRCb3VuZGluZ0NsMi50b3A7XG5cbiAgICAgICAgICAgIHZhciB0aHVtYkhlaWdodCA9IHRoaXMuZ2V0VGh1bWJWZXJ0aWNhbEhlaWdodCgpO1xuICAgICAgICAgICAgdmFyIG9mZnNldCA9IE1hdGguYWJzKHRhcmdldFRvcCAtIGNsaWVudFkpIC0gdGh1bWJIZWlnaHQgLyAyO1xuICAgICAgICAgICAgdGhpcy52aWV3LnNjcm9sbFRvcCA9IHRoaXMuZ2V0U2Nyb2xsVG9wRm9yT2Zmc2V0KG9mZnNldCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2hhbmRsZUhvcml6b250YWxUaHVtYk1vdXNlRG93bicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGVIb3Jpem9udGFsVGh1bWJNb3VzZURvd24oZXZlbnQpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZURyYWdTdGFydChldmVudCk7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0LFxuICAgICAgICAgICAgICAgIGNsaWVudFggPSBldmVudC5jbGllbnRYO1xuICAgICAgICAgICAgdmFyIG9mZnNldFdpZHRoID0gdGFyZ2V0Lm9mZnNldFdpZHRoO1xuXG4gICAgICAgICAgICB2YXIgX3RhcmdldCRnZXRCb3VuZGluZ0NsMyA9IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgICAgICAgICBsZWZ0ID0gX3RhcmdldCRnZXRCb3VuZGluZ0NsMy5sZWZ0O1xuXG4gICAgICAgICAgICB0aGlzLnByZXZQYWdlWCA9IG9mZnNldFdpZHRoIC0gKGNsaWVudFggLSBsZWZ0KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnaGFuZGxlVmVydGljYWxUaHVtYk1vdXNlRG93bicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGVWZXJ0aWNhbFRodW1iTW91c2VEb3duKGV2ZW50KSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVEcmFnU3RhcnQoZXZlbnQpO1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldCxcbiAgICAgICAgICAgICAgICBjbGllbnRZID0gZXZlbnQuY2xpZW50WTtcbiAgICAgICAgICAgIHZhciBvZmZzZXRIZWlnaHQgPSB0YXJnZXQub2Zmc2V0SGVpZ2h0O1xuXG4gICAgICAgICAgICB2YXIgX3RhcmdldCRnZXRCb3VuZGluZ0NsNCA9IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgICAgICAgICB0b3AgPSBfdGFyZ2V0JGdldEJvdW5kaW5nQ2w0LnRvcDtcblxuICAgICAgICAgICAgdGhpcy5wcmV2UGFnZVkgPSBvZmZzZXRIZWlnaHQgLSAoY2xpZW50WSAtIHRvcCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3NldHVwRHJhZ2dpbmcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0dXBEcmFnZ2luZygpIHtcbiAgICAgICAgICAgICgwLCBfZG9tQ3NzMltcImRlZmF1bHRcIl0pKGRvY3VtZW50LmJvZHksIF9zdHlsZXMuZGlzYWJsZVNlbGVjdFN0eWxlKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMuaGFuZGxlRHJhZyk7XG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5oYW5kbGVEcmFnRW5kKTtcbiAgICAgICAgICAgIGRvY3VtZW50Lm9uc2VsZWN0c3RhcnQgPSBfcmV0dXJuRmFsc2UyW1wiZGVmYXVsdFwiXTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndGVhcmRvd25EcmFnZ2luZycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0ZWFyZG93bkRyYWdnaW5nKCkge1xuICAgICAgICAgICAgKDAsIF9kb21Dc3MyW1wiZGVmYXVsdFwiXSkoZG9jdW1lbnQuYm9keSwgX3N0eWxlcy5kaXNhYmxlU2VsZWN0U3R5bGVSZXNldCk7XG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLmhhbmRsZURyYWcpO1xuICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuaGFuZGxlRHJhZ0VuZCk7XG4gICAgICAgICAgICBkb2N1bWVudC5vbnNlbGVjdHN0YXJ0ID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdoYW5kbGVEcmFnU3RhcnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlRHJhZ1N0YXJ0KGV2ZW50KSB7XG4gICAgICAgICAgICB0aGlzLmRyYWdnaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5zZXR1cERyYWdnaW5nKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2hhbmRsZURyYWcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlRHJhZyhldmVudCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldlBhZ2VYKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNsaWVudFggPSBldmVudC5jbGllbnRYO1xuXG4gICAgICAgICAgICAgICAgdmFyIF90cmFja0hvcml6b250YWwkZ2V0QiA9IHRoaXMudHJhY2tIb3Jpem9udGFsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAgICAgICAgICAgICB0cmFja0xlZnQgPSBfdHJhY2tIb3Jpem9udGFsJGdldEIubGVmdDtcblxuICAgICAgICAgICAgICAgIHZhciB0aHVtYldpZHRoID0gdGhpcy5nZXRUaHVtYkhvcml6b250YWxXaWR0aCgpO1xuICAgICAgICAgICAgICAgIHZhciBjbGlja1Bvc2l0aW9uID0gdGh1bWJXaWR0aCAtIHRoaXMucHJldlBhZ2VYO1xuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSAtdHJhY2tMZWZ0ICsgY2xpZW50WCAtIGNsaWNrUG9zaXRpb247XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3LnNjcm9sbExlZnQgPSB0aGlzLmdldFNjcm9sbExlZnRGb3JPZmZzZXQob2Zmc2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnByZXZQYWdlWSkge1xuICAgICAgICAgICAgICAgIHZhciBjbGllbnRZID0gZXZlbnQuY2xpZW50WTtcblxuICAgICAgICAgICAgICAgIHZhciBfdHJhY2tWZXJ0aWNhbCRnZXRCb3UgPSB0aGlzLnRyYWNrVmVydGljYWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgICAgICAgICAgICAgIHRyYWNrVG9wID0gX3RyYWNrVmVydGljYWwkZ2V0Qm91LnRvcDtcblxuICAgICAgICAgICAgICAgIHZhciB0aHVtYkhlaWdodCA9IHRoaXMuZ2V0VGh1bWJWZXJ0aWNhbEhlaWdodCgpO1xuICAgICAgICAgICAgICAgIHZhciBfY2xpY2tQb3NpdGlvbiA9IHRodW1iSGVpZ2h0IC0gdGhpcy5wcmV2UGFnZVk7XG4gICAgICAgICAgICAgICAgdmFyIF9vZmZzZXQgPSAtdHJhY2tUb3AgKyBjbGllbnRZIC0gX2NsaWNrUG9zaXRpb247XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3LnNjcm9sbFRvcCA9IHRoaXMuZ2V0U2Nyb2xsVG9wRm9yT2Zmc2V0KF9vZmZzZXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdoYW5kbGVEcmFnRW5kJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZURyYWdFbmQoKSB7XG4gICAgICAgICAgICB0aGlzLmRyYWdnaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnByZXZQYWdlWCA9IHRoaXMucHJldlBhZ2VZID0gMDtcbiAgICAgICAgICAgIHRoaXMudGVhcmRvd25EcmFnZ2luZygpO1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVEcmFnRW5kQXV0b0hpZGUoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnaGFuZGxlRHJhZ0VuZEF1dG9IaWRlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZURyYWdFbmRBdXRvSGlkZSgpIHtcbiAgICAgICAgICAgIHZhciBhdXRvSGlkZSA9IHRoaXMucHJvcHMuYXV0b0hpZGU7XG5cbiAgICAgICAgICAgIGlmICghYXV0b0hpZGUpIHJldHVybjtcbiAgICAgICAgICAgIHRoaXMuaGlkZVRyYWNrcygpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdoYW5kbGVUcmFja01vdXNlRW50ZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlVHJhY2tNb3VzZUVudGVyKCkge1xuICAgICAgICAgICAgdGhpcy50cmFja01vdXNlT3ZlciA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZVRyYWNrTW91c2VFbnRlckF1dG9IaWRlKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2hhbmRsZVRyYWNrTW91c2VFbnRlckF1dG9IaWRlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZVRyYWNrTW91c2VFbnRlckF1dG9IaWRlKCkge1xuICAgICAgICAgICAgdmFyIGF1dG9IaWRlID0gdGhpcy5wcm9wcy5hdXRvSGlkZTtcblxuICAgICAgICAgICAgaWYgKCFhdXRvSGlkZSkgcmV0dXJuO1xuICAgICAgICAgICAgdGhpcy5zaG93VHJhY2tzKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2hhbmRsZVRyYWNrTW91c2VMZWF2ZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGVUcmFja01vdXNlTGVhdmUoKSB7XG4gICAgICAgICAgICB0aGlzLnRyYWNrTW91c2VPdmVyID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZVRyYWNrTW91c2VMZWF2ZUF1dG9IaWRlKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2hhbmRsZVRyYWNrTW91c2VMZWF2ZUF1dG9IaWRlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZVRyYWNrTW91c2VMZWF2ZUF1dG9IaWRlKCkge1xuICAgICAgICAgICAgdmFyIGF1dG9IaWRlID0gdGhpcy5wcm9wcy5hdXRvSGlkZTtcblxuICAgICAgICAgICAgaWYgKCFhdXRvSGlkZSkgcmV0dXJuO1xuICAgICAgICAgICAgdGhpcy5oaWRlVHJhY2tzKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3Nob3dUcmFja3MnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2hvd1RyYWNrcygpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmhpZGVUcmFja3NUaW1lb3V0KTtcbiAgICAgICAgICAgICgwLCBfZG9tQ3NzMltcImRlZmF1bHRcIl0pKHRoaXMudHJhY2tIb3Jpem9udGFsLCB7IG9wYWNpdHk6IDEgfSk7XG4gICAgICAgICAgICAoMCwgX2RvbUNzczJbXCJkZWZhdWx0XCJdKSh0aGlzLnRyYWNrVmVydGljYWwsIHsgb3BhY2l0eTogMSB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnaGlkZVRyYWNrcycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBoaWRlVHJhY2tzKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmRyYWdnaW5nKSByZXR1cm47XG4gICAgICAgICAgICBpZiAodGhpcy5zY3JvbGxpbmcpIHJldHVybjtcbiAgICAgICAgICAgIGlmICh0aGlzLnRyYWNrTW91c2VPdmVyKSByZXR1cm47XG4gICAgICAgICAgICB2YXIgYXV0b0hpZGVUaW1lb3V0ID0gdGhpcy5wcm9wcy5hdXRvSGlkZVRpbWVvdXQ7XG5cbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmhpZGVUcmFja3NUaW1lb3V0KTtcbiAgICAgICAgICAgIHRoaXMuaGlkZVRyYWNrc1RpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAoMCwgX2RvbUNzczJbXCJkZWZhdWx0XCJdKShfdGhpczMudHJhY2tIb3Jpem9udGFsLCB7IG9wYWNpdHk6IDAgfSk7XG4gICAgICAgICAgICAgICAgKDAsIF9kb21Dc3MyW1wiZGVmYXVsdFwiXSkoX3RoaXMzLnRyYWNrVmVydGljYWwsIHsgb3BhY2l0eTogMCB9KTtcbiAgICAgICAgICAgIH0sIGF1dG9IaWRlVGltZW91dCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2RldGVjdFNjcm9sbGluZycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXRlY3RTY3JvbGxpbmcoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXM0ID0gdGhpcztcblxuICAgICAgICAgICAgaWYgKHRoaXMuc2Nyb2xsaW5nKSByZXR1cm47XG4gICAgICAgICAgICB0aGlzLnNjcm9sbGluZyA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZVNjcm9sbFN0YXJ0KCk7XG4gICAgICAgICAgICB0aGlzLmRldGVjdFNjcm9sbGluZ0ludGVydmFsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChfdGhpczQubGFzdFZpZXdTY3JvbGxMZWZ0ID09PSBfdGhpczQudmlld1Njcm9sbExlZnQgJiYgX3RoaXM0Lmxhc3RWaWV3U2Nyb2xsVG9wID09PSBfdGhpczQudmlld1Njcm9sbFRvcCkge1xuICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKF90aGlzNC5kZXRlY3RTY3JvbGxpbmdJbnRlcnZhbCk7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzNC5zY3JvbGxpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXM0LmhhbmRsZVNjcm9sbFN0b3AoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX3RoaXM0Lmxhc3RWaWV3U2Nyb2xsTGVmdCA9IF90aGlzNC52aWV3U2Nyb2xsTGVmdDtcbiAgICAgICAgICAgICAgICBfdGhpczQubGFzdFZpZXdTY3JvbGxUb3AgPSBfdGhpczQudmlld1Njcm9sbFRvcDtcbiAgICAgICAgICAgIH0sIDEwMCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3JhZicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByYWYoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHZhciBfdGhpczUgPSB0aGlzO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5yZXF1ZXN0RnJhbWUpIF9yYWYzW1wiZGVmYXVsdFwiXS5jYW5jZWwodGhpcy5yZXF1ZXN0RnJhbWUpO1xuICAgICAgICAgICAgdGhpcy5yZXF1ZXN0RnJhbWUgPSAoMCwgX3JhZjNbXCJkZWZhdWx0XCJdKShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXM1LnJlcXVlc3RGcmFtZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3VwZGF0ZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGUoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHZhciBfdGhpczYgPSB0aGlzO1xuXG4gICAgICAgICAgICB0aGlzLnJhZihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNi5fdXBkYXRlKGNhbGxiYWNrKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfdXBkYXRlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF91cGRhdGUoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHZhciBfcHJvcHM0ID0gdGhpcy5wcm9wcyxcbiAgICAgICAgICAgICAgICBvblVwZGF0ZSA9IF9wcm9wczQub25VcGRhdGUsXG4gICAgICAgICAgICAgICAgaGlkZVRyYWNrc1doZW5Ob3ROZWVkZWQgPSBfcHJvcHM0LmhpZGVUcmFja3NXaGVuTm90TmVlZGVkO1xuXG4gICAgICAgICAgICB2YXIgdmFsdWVzID0gdGhpcy5nZXRWYWx1ZXMoKTtcbiAgICAgICAgICAgIGlmICgoMCwgX2dldFNjcm9sbGJhcldpZHRoMltcImRlZmF1bHRcIl0pKCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2Nyb2xsTGVmdCA9IHZhbHVlcy5zY3JvbGxMZWZ0LFxuICAgICAgICAgICAgICAgICAgICBjbGllbnRXaWR0aCA9IHZhbHVlcy5jbGllbnRXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsV2lkdGggPSB2YWx1ZXMuc2Nyb2xsV2lkdGg7XG5cbiAgICAgICAgICAgICAgICB2YXIgdHJhY2tIb3Jpem9udGFsV2lkdGggPSAoMCwgX2dldElubmVyV2lkdGgyW1wiZGVmYXVsdFwiXSkodGhpcy50cmFja0hvcml6b250YWwpO1xuICAgICAgICAgICAgICAgIHZhciB0aHVtYkhvcml6b250YWxXaWR0aCA9IHRoaXMuZ2V0VGh1bWJIb3Jpem9udGFsV2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgdGh1bWJIb3Jpem9udGFsWCA9IHNjcm9sbExlZnQgLyAoc2Nyb2xsV2lkdGggLSBjbGllbnRXaWR0aCkgKiAodHJhY2tIb3Jpem9udGFsV2lkdGggLSB0aHVtYkhvcml6b250YWxXaWR0aCk7XG4gICAgICAgICAgICAgICAgdmFyIHRodW1iSG9yaXpvbnRhbFN0eWxlID0ge1xuICAgICAgICAgICAgICAgICAgICB3aWR0aDogdGh1bWJIb3Jpem9udGFsV2lkdGgsXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZVgoJyArIHRodW1iSG9yaXpvbnRhbFggKyAncHgpJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIHNjcm9sbFRvcCA9IHZhbHVlcy5zY3JvbGxUb3AsXG4gICAgICAgICAgICAgICAgICAgIGNsaWVudEhlaWdodCA9IHZhbHVlcy5jbGllbnRIZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbEhlaWdodCA9IHZhbHVlcy5zY3JvbGxIZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgdHJhY2tWZXJ0aWNhbEhlaWdodCA9ICgwLCBfZ2V0SW5uZXJIZWlnaHQyW1wiZGVmYXVsdFwiXSkodGhpcy50cmFja1ZlcnRpY2FsKTtcbiAgICAgICAgICAgICAgICB2YXIgdGh1bWJWZXJ0aWNhbEhlaWdodCA9IHRoaXMuZ2V0VGh1bWJWZXJ0aWNhbEhlaWdodCgpO1xuICAgICAgICAgICAgICAgIHZhciB0aHVtYlZlcnRpY2FsWSA9IHNjcm9sbFRvcCAvIChzY3JvbGxIZWlnaHQgLSBjbGllbnRIZWlnaHQpICogKHRyYWNrVmVydGljYWxIZWlnaHQgLSB0aHVtYlZlcnRpY2FsSGVpZ2h0KTtcbiAgICAgICAgICAgICAgICB2YXIgdGh1bWJWZXJ0aWNhbFN0eWxlID0ge1xuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHRodW1iVmVydGljYWxIZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZVkoJyArIHRodW1iVmVydGljYWxZICsgJ3B4KSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmIChoaWRlVHJhY2tzV2hlbk5vdE5lZWRlZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhY2tIb3Jpem9udGFsU3R5bGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmlsaXR5OiBzY3JvbGxXaWR0aCA+IGNsaWVudFdpZHRoID8gJ3Zpc2libGUnIDogJ2hpZGRlbidcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYWNrVmVydGljYWxTdHlsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6IHNjcm9sbEhlaWdodCA+IGNsaWVudEhlaWdodCA/ICd2aXNpYmxlJyA6ICdoaWRkZW4nXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICgwLCBfZG9tQ3NzMltcImRlZmF1bHRcIl0pKHRoaXMudHJhY2tIb3Jpem9udGFsLCB0cmFja0hvcml6b250YWxTdHlsZSk7XG4gICAgICAgICAgICAgICAgICAgICgwLCBfZG9tQ3NzMltcImRlZmF1bHRcIl0pKHRoaXMudHJhY2tWZXJ0aWNhbCwgdHJhY2tWZXJ0aWNhbFN0eWxlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKDAsIF9kb21Dc3MyW1wiZGVmYXVsdFwiXSkodGhpcy50aHVtYkhvcml6b250YWwsIHRodW1iSG9yaXpvbnRhbFN0eWxlKTtcbiAgICAgICAgICAgICAgICAoMCwgX2RvbUNzczJbXCJkZWZhdWx0XCJdKSh0aGlzLnRodW1iVmVydGljYWwsIHRodW1iVmVydGljYWxTdHlsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob25VcGRhdGUpIG9uVXBkYXRlKHZhbHVlcyk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrICE9PSAnZnVuY3Rpb24nKSByZXR1cm47XG4gICAgICAgICAgICBjYWxsYmFjayh2YWx1ZXMpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZW5kZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzNyA9IHRoaXM7XG5cbiAgICAgICAgICAgIHZhciBzY3JvbGxiYXJXaWR0aCA9ICgwLCBfZ2V0U2Nyb2xsYmFyV2lkdGgyW1wiZGVmYXVsdFwiXSkoKTtcbiAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLXVudXNlZC12YXJzICovXG5cbiAgICAgICAgICAgIHZhciBfcHJvcHM1ID0gdGhpcy5wcm9wcyxcbiAgICAgICAgICAgICAgICBvblNjcm9sbCA9IF9wcm9wczUub25TY3JvbGwsXG4gICAgICAgICAgICAgICAgb25TY3JvbGxGcmFtZSA9IF9wcm9wczUub25TY3JvbGxGcmFtZSxcbiAgICAgICAgICAgICAgICBvblNjcm9sbFN0YXJ0ID0gX3Byb3BzNS5vblNjcm9sbFN0YXJ0LFxuICAgICAgICAgICAgICAgIG9uU2Nyb2xsU3RvcCA9IF9wcm9wczUub25TY3JvbGxTdG9wLFxuICAgICAgICAgICAgICAgIG9uVXBkYXRlID0gX3Byb3BzNS5vblVwZGF0ZSxcbiAgICAgICAgICAgICAgICByZW5kZXJWaWV3ID0gX3Byb3BzNS5yZW5kZXJWaWV3LFxuICAgICAgICAgICAgICAgIHJlbmRlclRyYWNrSG9yaXpvbnRhbCA9IF9wcm9wczUucmVuZGVyVHJhY2tIb3Jpem9udGFsLFxuICAgICAgICAgICAgICAgIHJlbmRlclRyYWNrVmVydGljYWwgPSBfcHJvcHM1LnJlbmRlclRyYWNrVmVydGljYWwsXG4gICAgICAgICAgICAgICAgcmVuZGVyVGh1bWJIb3Jpem9udGFsID0gX3Byb3BzNS5yZW5kZXJUaHVtYkhvcml6b250YWwsXG4gICAgICAgICAgICAgICAgcmVuZGVyVGh1bWJWZXJ0aWNhbCA9IF9wcm9wczUucmVuZGVyVGh1bWJWZXJ0aWNhbCxcbiAgICAgICAgICAgICAgICB0YWdOYW1lID0gX3Byb3BzNS50YWdOYW1lLFxuICAgICAgICAgICAgICAgIGhpZGVUcmFja3NXaGVuTm90TmVlZGVkID0gX3Byb3BzNS5oaWRlVHJhY2tzV2hlbk5vdE5lZWRlZCxcbiAgICAgICAgICAgICAgICBhdXRvSGlkZSA9IF9wcm9wczUuYXV0b0hpZGUsXG4gICAgICAgICAgICAgICAgYXV0b0hpZGVUaW1lb3V0ID0gX3Byb3BzNS5hdXRvSGlkZVRpbWVvdXQsXG4gICAgICAgICAgICAgICAgYXV0b0hpZGVEdXJhdGlvbiA9IF9wcm9wczUuYXV0b0hpZGVEdXJhdGlvbixcbiAgICAgICAgICAgICAgICB0aHVtYlNpemUgPSBfcHJvcHM1LnRodW1iU2l6ZSxcbiAgICAgICAgICAgICAgICB0aHVtYk1pblNpemUgPSBfcHJvcHM1LnRodW1iTWluU2l6ZSxcbiAgICAgICAgICAgICAgICB1bml2ZXJzYWwgPSBfcHJvcHM1LnVuaXZlcnNhbCxcbiAgICAgICAgICAgICAgICBhdXRvSGVpZ2h0ID0gX3Byb3BzNS5hdXRvSGVpZ2h0LFxuICAgICAgICAgICAgICAgIGF1dG9IZWlnaHRNaW4gPSBfcHJvcHM1LmF1dG9IZWlnaHRNaW4sXG4gICAgICAgICAgICAgICAgYXV0b0hlaWdodE1heCA9IF9wcm9wczUuYXV0b0hlaWdodE1heCxcbiAgICAgICAgICAgICAgICBzdHlsZSA9IF9wcm9wczUuc3R5bGUsXG4gICAgICAgICAgICAgICAgY2hpbGRyZW4gPSBfcHJvcHM1LmNoaWxkcmVuLFxuICAgICAgICAgICAgICAgIHByb3BzID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKF9wcm9wczUsIFsnb25TY3JvbGwnLCAnb25TY3JvbGxGcmFtZScsICdvblNjcm9sbFN0YXJ0JywgJ29uU2Nyb2xsU3RvcCcsICdvblVwZGF0ZScsICdyZW5kZXJWaWV3JywgJ3JlbmRlclRyYWNrSG9yaXpvbnRhbCcsICdyZW5kZXJUcmFja1ZlcnRpY2FsJywgJ3JlbmRlclRodW1iSG9yaXpvbnRhbCcsICdyZW5kZXJUaHVtYlZlcnRpY2FsJywgJ3RhZ05hbWUnLCAnaGlkZVRyYWNrc1doZW5Ob3ROZWVkZWQnLCAnYXV0b0hpZGUnLCAnYXV0b0hpZGVUaW1lb3V0JywgJ2F1dG9IaWRlRHVyYXRpb24nLCAndGh1bWJTaXplJywgJ3RodW1iTWluU2l6ZScsICd1bml2ZXJzYWwnLCAnYXV0b0hlaWdodCcsICdhdXRvSGVpZ2h0TWluJywgJ2F1dG9IZWlnaHRNYXgnLCAnc3R5bGUnLCAnY2hpbGRyZW4nXSk7XG4gICAgICAgICAgICAvKiBlc2xpbnQtZW5hYmxlIG5vLXVudXNlZC12YXJzICovXG5cbiAgICAgICAgICAgIHZhciBkaWRNb3VudFVuaXZlcnNhbCA9IHRoaXMuc3RhdGUuZGlkTW91bnRVbml2ZXJzYWw7XG5cblxuICAgICAgICAgICAgdmFyIGNvbnRhaW5lclN0eWxlID0gX2V4dGVuZHMoe30sIF9zdHlsZXMuY29udGFpbmVyU3R5bGVEZWZhdWx0LCBhdXRvSGVpZ2h0ICYmIF9leHRlbmRzKHt9LCBfc3R5bGVzLmNvbnRhaW5lclN0eWxlQXV0b0hlaWdodCwge1xuICAgICAgICAgICAgICAgIG1pbkhlaWdodDogYXV0b0hlaWdodE1pbixcbiAgICAgICAgICAgICAgICBtYXhIZWlnaHQ6IGF1dG9IZWlnaHRNYXhcbiAgICAgICAgICAgIH0pLCBzdHlsZSk7XG5cbiAgICAgICAgICAgIHZhciB2aWV3U3R5bGUgPSBfZXh0ZW5kcyh7fSwgX3N0eWxlcy52aWV3U3R5bGVEZWZhdWx0LCB7XG4gICAgICAgICAgICAgICAgLy8gSGlkZSBzY3JvbGxiYXJzIGJ5IHNldHRpbmcgYSBuZWdhdGl2ZSBtYXJnaW5cbiAgICAgICAgICAgICAgICBtYXJnaW5SaWdodDogc2Nyb2xsYmFyV2lkdGggPyAtc2Nyb2xsYmFyV2lkdGggOiAwLFxuICAgICAgICAgICAgICAgIG1hcmdpbkJvdHRvbTogc2Nyb2xsYmFyV2lkdGggPyAtc2Nyb2xsYmFyV2lkdGggOiAwXG4gICAgICAgICAgICB9LCBhdXRvSGVpZ2h0ICYmIF9leHRlbmRzKHt9LCBfc3R5bGVzLnZpZXdTdHlsZUF1dG9IZWlnaHQsIHtcbiAgICAgICAgICAgICAgICAvLyBBZGQgc2Nyb2xsYmFyV2lkdGggdG8gYXV0b0hlaWdodCBpbiBvcmRlciB0byBjb21wZW5zYXRlIG5lZ2F0aXZlIG1hcmdpbnNcbiAgICAgICAgICAgICAgICBtaW5IZWlnaHQ6ICgwLCBfaXNTdHJpbmcyW1wiZGVmYXVsdFwiXSkoYXV0b0hlaWdodE1pbikgPyAnY2FsYygnICsgYXV0b0hlaWdodE1pbiArICcgKyAnICsgc2Nyb2xsYmFyV2lkdGggKyAncHgpJyA6IGF1dG9IZWlnaHRNaW4gKyBzY3JvbGxiYXJXaWR0aCxcbiAgICAgICAgICAgICAgICBtYXhIZWlnaHQ6ICgwLCBfaXNTdHJpbmcyW1wiZGVmYXVsdFwiXSkoYXV0b0hlaWdodE1heCkgPyAnY2FsYygnICsgYXV0b0hlaWdodE1heCArICcgKyAnICsgc2Nyb2xsYmFyV2lkdGggKyAncHgpJyA6IGF1dG9IZWlnaHRNYXggKyBzY3JvbGxiYXJXaWR0aFxuICAgICAgICAgICAgfSksIGF1dG9IZWlnaHQgJiYgdW5pdmVyc2FsICYmICFkaWRNb3VudFVuaXZlcnNhbCAmJiB7XG4gICAgICAgICAgICAgICAgbWluSGVpZ2h0OiBhdXRvSGVpZ2h0TWluLFxuICAgICAgICAgICAgICAgIG1heEhlaWdodDogYXV0b0hlaWdodE1heFxuICAgICAgICAgICAgfSwgdW5pdmVyc2FsICYmICFkaWRNb3VudFVuaXZlcnNhbCAmJiBfc3R5bGVzLnZpZXdTdHlsZVVuaXZlcnNhbEluaXRpYWwpO1xuXG4gICAgICAgICAgICB2YXIgdHJhY2tBdXRvSGVpZ2h0U3R5bGUgPSB7XG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbjogJ29wYWNpdHkgJyArIGF1dG9IaWRlRHVyYXRpb24gKyAnbXMnLFxuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDBcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciB0cmFja0hvcml6b250YWxTdHlsZSA9IF9leHRlbmRzKHt9LCBfc3R5bGVzLnRyYWNrSG9yaXpvbnRhbFN0eWxlRGVmYXVsdCwgYXV0b0hpZGUgJiYgdHJhY2tBdXRvSGVpZ2h0U3R5bGUsICghc2Nyb2xsYmFyV2lkdGggfHwgdW5pdmVyc2FsICYmICFkaWRNb3VudFVuaXZlcnNhbCkgJiYge1xuICAgICAgICAgICAgICAgIGRpc3BsYXk6ICdub25lJ1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHZhciB0cmFja1ZlcnRpY2FsU3R5bGUgPSBfZXh0ZW5kcyh7fSwgX3N0eWxlcy50cmFja1ZlcnRpY2FsU3R5bGVEZWZhdWx0LCBhdXRvSGlkZSAmJiB0cmFja0F1dG9IZWlnaHRTdHlsZSwgKCFzY3JvbGxiYXJXaWR0aCB8fCB1bml2ZXJzYWwgJiYgIWRpZE1vdW50VW5pdmVyc2FsKSAmJiB7XG4gICAgICAgICAgICAgICAgZGlzcGxheTogJ25vbmUnXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuICgwLCBfcmVhY3QuY3JlYXRlRWxlbWVudCkodGFnTmFtZSwgX2V4dGVuZHMoe30sIHByb3BzLCB7IHN0eWxlOiBjb250YWluZXJTdHlsZSwgcmVmOiBmdW5jdGlvbiByZWYoX3JlZjMpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXM3LmNvbnRhaW5lciA9IF9yZWYzO1xuICAgICAgICAgICAgICAgIH0gfSksIFsoMCwgX3JlYWN0LmNsb25lRWxlbWVudCkocmVuZGVyVmlldyh7IHN0eWxlOiB2aWV3U3R5bGUgfSksIHsga2V5OiAndmlldycsIHJlZjogZnVuY3Rpb24gcmVmKF9yZWY0KSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzNy52aWV3ID0gX3JlZjQ7XG4gICAgICAgICAgICAgICAgfSB9LCBjaGlsZHJlbiksICgwLCBfcmVhY3QuY2xvbmVFbGVtZW50KShyZW5kZXJUcmFja0hvcml6b250YWwoeyBzdHlsZTogdHJhY2tIb3Jpem9udGFsU3R5bGUgfSksIHsga2V5OiAndHJhY2tIb3Jpem9udGFsJywgcmVmOiBmdW5jdGlvbiByZWYoX3JlZjUpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXM3LnRyYWNrSG9yaXpvbnRhbCA9IF9yZWY1O1xuICAgICAgICAgICAgICAgIH0gfSwgKDAsIF9yZWFjdC5jbG9uZUVsZW1lbnQpKHJlbmRlclRodW1iSG9yaXpvbnRhbCh7IHN0eWxlOiBfc3R5bGVzLnRodW1iSG9yaXpvbnRhbFN0eWxlRGVmYXVsdCB9KSwgeyByZWY6IGZ1bmN0aW9uIHJlZihfcmVmNikge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczcudGh1bWJIb3Jpem9udGFsID0gX3JlZjY7XG4gICAgICAgICAgICAgICAgfSB9KSksICgwLCBfcmVhY3QuY2xvbmVFbGVtZW50KShyZW5kZXJUcmFja1ZlcnRpY2FsKHsgc3R5bGU6IHRyYWNrVmVydGljYWxTdHlsZSB9KSwgeyBrZXk6ICd0cmFja1ZlcnRpY2FsJywgcmVmOiBmdW5jdGlvbiByZWYoX3JlZjcpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXM3LnRyYWNrVmVydGljYWwgPSBfcmVmNztcbiAgICAgICAgICAgICAgICB9IH0sICgwLCBfcmVhY3QuY2xvbmVFbGVtZW50KShyZW5kZXJUaHVtYlZlcnRpY2FsKHsgc3R5bGU6IF9zdHlsZXMudGh1bWJWZXJ0aWNhbFN0eWxlRGVmYXVsdCB9KSwgeyByZWY6IGZ1bmN0aW9uIHJlZihfcmVmOCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczcudGh1bWJWZXJ0aWNhbCA9IF9yZWY4O1xuICAgICAgICAgICAgICAgIH0gfSkpXSk7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gU2Nyb2xsYmFycztcbn0oX3JlYWN0LkNvbXBvbmVudCk7XG5cbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gU2Nyb2xsYmFycztcblxuXG5TY3JvbGxiYXJzLnByb3BUeXBlcyA9IHtcbiAgICBvblNjcm9sbDogX3Byb3BUeXBlczJbXCJkZWZhdWx0XCJdLmZ1bmMsXG4gICAgb25TY3JvbGxGcmFtZTogX3Byb3BUeXBlczJbXCJkZWZhdWx0XCJdLmZ1bmMsXG4gICAgb25TY3JvbGxTdGFydDogX3Byb3BUeXBlczJbXCJkZWZhdWx0XCJdLmZ1bmMsXG4gICAgb25TY3JvbGxTdG9wOiBfcHJvcFR5cGVzMltcImRlZmF1bHRcIl0uZnVuYyxcbiAgICBvblVwZGF0ZTogX3Byb3BUeXBlczJbXCJkZWZhdWx0XCJdLmZ1bmMsXG4gICAgcmVuZGVyVmlldzogX3Byb3BUeXBlczJbXCJkZWZhdWx0XCJdLmZ1bmMsXG4gICAgcmVuZGVyVHJhY2tIb3Jpem9udGFsOiBfcHJvcFR5cGVzMltcImRlZmF1bHRcIl0uZnVuYyxcbiAgICByZW5kZXJUcmFja1ZlcnRpY2FsOiBfcHJvcFR5cGVzMltcImRlZmF1bHRcIl0uZnVuYyxcbiAgICByZW5kZXJUaHVtYkhvcml6b250YWw6IF9wcm9wVHlwZXMyW1wiZGVmYXVsdFwiXS5mdW5jLFxuICAgIHJlbmRlclRodW1iVmVydGljYWw6IF9wcm9wVHlwZXMyW1wiZGVmYXVsdFwiXS5mdW5jLFxuICAgIHRhZ05hbWU6IF9wcm9wVHlwZXMyW1wiZGVmYXVsdFwiXS5zdHJpbmcsXG4gICAgdGh1bWJTaXplOiBfcHJvcFR5cGVzMltcImRlZmF1bHRcIl0ubnVtYmVyLFxuICAgIHRodW1iTWluU2l6ZTogX3Byb3BUeXBlczJbXCJkZWZhdWx0XCJdLm51bWJlcixcbiAgICBoaWRlVHJhY2tzV2hlbk5vdE5lZWRlZDogX3Byb3BUeXBlczJbXCJkZWZhdWx0XCJdLmJvb2wsXG4gICAgYXV0b0hpZGU6IF9wcm9wVHlwZXMyW1wiZGVmYXVsdFwiXS5ib29sLFxuICAgIGF1dG9IaWRlVGltZW91dDogX3Byb3BUeXBlczJbXCJkZWZhdWx0XCJdLm51bWJlcixcbiAgICBhdXRvSGlkZUR1cmF0aW9uOiBfcHJvcFR5cGVzMltcImRlZmF1bHRcIl0ubnVtYmVyLFxuICAgIGF1dG9IZWlnaHQ6IF9wcm9wVHlwZXMyW1wiZGVmYXVsdFwiXS5ib29sLFxuICAgIGF1dG9IZWlnaHRNaW46IF9wcm9wVHlwZXMyW1wiZGVmYXVsdFwiXS5vbmVPZlR5cGUoW19wcm9wVHlwZXMyW1wiZGVmYXVsdFwiXS5udW1iZXIsIF9wcm9wVHlwZXMyW1wiZGVmYXVsdFwiXS5zdHJpbmddKSxcbiAgICBhdXRvSGVpZ2h0TWF4OiBfcHJvcFR5cGVzMltcImRlZmF1bHRcIl0ub25lT2ZUeXBlKFtfcHJvcFR5cGVzMltcImRlZmF1bHRcIl0ubnVtYmVyLCBfcHJvcFR5cGVzMltcImRlZmF1bHRcIl0uc3RyaW5nXSksXG4gICAgdW5pdmVyc2FsOiBfcHJvcFR5cGVzMltcImRlZmF1bHRcIl0uYm9vbCxcbiAgICBzdHlsZTogX3Byb3BUeXBlczJbXCJkZWZhdWx0XCJdLm9iamVjdCxcbiAgICBjaGlsZHJlbjogX3Byb3BUeXBlczJbXCJkZWZhdWx0XCJdLm5vZGVcbn07XG5cblNjcm9sbGJhcnMuZGVmYXVsdFByb3BzID0ge1xuICAgIHJlbmRlclZpZXc6IF9kZWZhdWx0UmVuZGVyRWxlbWVudHMucmVuZGVyVmlld0RlZmF1bHQsXG4gICAgcmVuZGVyVHJhY2tIb3Jpem9udGFsOiBfZGVmYXVsdFJlbmRlckVsZW1lbnRzLnJlbmRlclRyYWNrSG9yaXpvbnRhbERlZmF1bHQsXG4gICAgcmVuZGVyVHJhY2tWZXJ0aWNhbDogX2RlZmF1bHRSZW5kZXJFbGVtZW50cy5yZW5kZXJUcmFja1ZlcnRpY2FsRGVmYXVsdCxcbiAgICByZW5kZXJUaHVtYkhvcml6b250YWw6IF9kZWZhdWx0UmVuZGVyRWxlbWVudHMucmVuZGVyVGh1bWJIb3Jpem9udGFsRGVmYXVsdCxcbiAgICByZW5kZXJUaHVtYlZlcnRpY2FsOiBfZGVmYXVsdFJlbmRlckVsZW1lbnRzLnJlbmRlclRodW1iVmVydGljYWxEZWZhdWx0LFxuICAgIHRhZ05hbWU6ICdkaXYnLFxuICAgIHRodW1iTWluU2l6ZTogMzAsXG4gICAgaGlkZVRyYWNrc1doZW5Ob3ROZWVkZWQ6IGZhbHNlLFxuICAgIGF1dG9IaWRlOiBmYWxzZSxcbiAgICBhdXRvSGlkZVRpbWVvdXQ6IDEwMDAsXG4gICAgYXV0b0hpZGVEdXJhdGlvbjogMjAwLFxuICAgIGF1dG9IZWlnaHQ6IGZhbHNlLFxuICAgIGF1dG9IZWlnaHRNaW46IDAsXG4gICAgYXV0b0hlaWdodE1heDogMjAwLFxuICAgIHVuaXZlcnNhbDogZmFsc2Vcbn07IiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG52YXIgY29udGFpbmVyU3R5bGVEZWZhdWx0ID0gZXhwb3J0cy5jb250YWluZXJTdHlsZURlZmF1bHQgPSB7XG4gICAgcG9zaXRpb246ICdyZWxhdGl2ZScsXG4gICAgb3ZlcmZsb3c6ICdoaWRkZW4nLFxuICAgIHdpZHRoOiAnMTAwJScsXG4gICAgaGVpZ2h0OiAnMTAwJSdcbn07XG5cbi8vIE92ZXJyaWRlcyBjb250YWluZXJTdHlsZURlZmF1bHQgcHJvcGVydGllc1xudmFyIGNvbnRhaW5lclN0eWxlQXV0b0hlaWdodCA9IGV4cG9ydHMuY29udGFpbmVyU3R5bGVBdXRvSGVpZ2h0ID0ge1xuICAgIGhlaWdodDogJ2F1dG8nXG59O1xuXG52YXIgdmlld1N0eWxlRGVmYXVsdCA9IGV4cG9ydHMudmlld1N0eWxlRGVmYXVsdCA9IHtcbiAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICB0b3A6IDAsXG4gICAgbGVmdDogMCxcbiAgICByaWdodDogMCxcbiAgICBib3R0b206IDAsXG4gICAgb3ZlcmZsb3c6ICdzY3JvbGwnLFxuICAgIFdlYmtpdE92ZXJmbG93U2Nyb2xsaW5nOiAndG91Y2gnXG59O1xuXG4vLyBPdmVycmlkZXMgdmlld1N0eWxlRGVmYXVsdCBwcm9wZXJ0aWVzXG52YXIgdmlld1N0eWxlQXV0b0hlaWdodCA9IGV4cG9ydHMudmlld1N0eWxlQXV0b0hlaWdodCA9IHtcbiAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJyxcbiAgICB0b3A6IHVuZGVmaW5lZCxcbiAgICBsZWZ0OiB1bmRlZmluZWQsXG4gICAgcmlnaHQ6IHVuZGVmaW5lZCxcbiAgICBib3R0b206IHVuZGVmaW5lZFxufTtcblxudmFyIHZpZXdTdHlsZVVuaXZlcnNhbEluaXRpYWwgPSBleHBvcnRzLnZpZXdTdHlsZVVuaXZlcnNhbEluaXRpYWwgPSB7XG4gICAgb3ZlcmZsb3c6ICdoaWRkZW4nLFxuICAgIG1hcmdpblJpZ2h0OiAwLFxuICAgIG1hcmdpbkJvdHRvbTogMFxufTtcblxudmFyIHRyYWNrSG9yaXpvbnRhbFN0eWxlRGVmYXVsdCA9IGV4cG9ydHMudHJhY2tIb3Jpem9udGFsU3R5bGVEZWZhdWx0ID0ge1xuICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgIGhlaWdodDogNlxufTtcblxudmFyIHRyYWNrVmVydGljYWxTdHlsZURlZmF1bHQgPSBleHBvcnRzLnRyYWNrVmVydGljYWxTdHlsZURlZmF1bHQgPSB7XG4gICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgd2lkdGg6IDZcbn07XG5cbnZhciB0aHVtYkhvcml6b250YWxTdHlsZURlZmF1bHQgPSBleHBvcnRzLnRodW1iSG9yaXpvbnRhbFN0eWxlRGVmYXVsdCA9IHtcbiAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJyxcbiAgICBkaXNwbGF5OiAnYmxvY2snLFxuICAgIGhlaWdodDogJzEwMCUnXG59O1xuXG52YXIgdGh1bWJWZXJ0aWNhbFN0eWxlRGVmYXVsdCA9IGV4cG9ydHMudGh1bWJWZXJ0aWNhbFN0eWxlRGVmYXVsdCA9IHtcbiAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJyxcbiAgICBkaXNwbGF5OiAnYmxvY2snLFxuICAgIHdpZHRoOiAnMTAwJSdcbn07XG5cbnZhciBkaXNhYmxlU2VsZWN0U3R5bGUgPSBleHBvcnRzLmRpc2FibGVTZWxlY3RTdHlsZSA9IHtcbiAgICB1c2VyU2VsZWN0OiAnbm9uZSdcbn07XG5cbnZhciBkaXNhYmxlU2VsZWN0U3R5bGVSZXNldCA9IGV4cG9ydHMuZGlzYWJsZVNlbGVjdFN0eWxlUmVzZXQgPSB7XG4gICAgdXNlclNlbGVjdDogJydcbn07IiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5TY3JvbGxiYXJzID0gdW5kZWZpbmVkO1xuXG52YXIgX1Njcm9sbGJhcnMgPSByZXF1aXJlKCcuL1Njcm9sbGJhcnMnKTtcblxudmFyIF9TY3JvbGxiYXJzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1Njcm9sbGJhcnMpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBcImRlZmF1bHRcIjogb2JqIH07IH1cblxuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBfU2Nyb2xsYmFyczJbXCJkZWZhdWx0XCJdO1xuZXhwb3J0cy5TY3JvbGxiYXJzID0gX1Njcm9sbGJhcnMyW1wiZGVmYXVsdFwiXTsiLCJcInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBnZXRJbm5lckhlaWdodDtcbmZ1bmN0aW9uIGdldElubmVySGVpZ2h0KGVsKSB7XG4gICAgdmFyIGNsaWVudEhlaWdodCA9IGVsLmNsaWVudEhlaWdodDtcblxuICAgIHZhciBfZ2V0Q29tcHV0ZWRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZWwpLFxuICAgICAgICBwYWRkaW5nVG9wID0gX2dldENvbXB1dGVkU3R5bGUucGFkZGluZ1RvcCxcbiAgICAgICAgcGFkZGluZ0JvdHRvbSA9IF9nZXRDb21wdXRlZFN0eWxlLnBhZGRpbmdCb3R0b207XG5cbiAgICByZXR1cm4gY2xpZW50SGVpZ2h0IC0gcGFyc2VGbG9hdChwYWRkaW5nVG9wKSAtIHBhcnNlRmxvYXQocGFkZGluZ0JvdHRvbSk7XG59IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gZ2V0SW5uZXJXaWR0aDtcbmZ1bmN0aW9uIGdldElubmVyV2lkdGgoZWwpIHtcbiAgICB2YXIgY2xpZW50V2lkdGggPSBlbC5jbGllbnRXaWR0aDtcblxuICAgIHZhciBfZ2V0Q29tcHV0ZWRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZWwpLFxuICAgICAgICBwYWRkaW5nTGVmdCA9IF9nZXRDb21wdXRlZFN0eWxlLnBhZGRpbmdMZWZ0LFxuICAgICAgICBwYWRkaW5nUmlnaHQgPSBfZ2V0Q29tcHV0ZWRTdHlsZS5wYWRkaW5nUmlnaHQ7XG5cbiAgICByZXR1cm4gY2xpZW50V2lkdGggLSBwYXJzZUZsb2F0KHBhZGRpbmdMZWZ0KSAtIHBhcnNlRmxvYXQocGFkZGluZ1JpZ2h0KTtcbn0iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gZ2V0U2Nyb2xsYmFyV2lkdGg7XG5cbnZhciBfZG9tQ3NzID0gcmVxdWlyZSgnZG9tLWNzcycpO1xuXG52YXIgX2RvbUNzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kb21Dc3MpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBcImRlZmF1bHRcIjogb2JqIH07IH1cblxudmFyIHNjcm9sbGJhcldpZHRoID0gZmFsc2U7XG5cbmZ1bmN0aW9uIGdldFNjcm9sbGJhcldpZHRoKCkge1xuICAgIHZhciBjYWNoZUVuYWJsZWQgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHRydWU7XG5cbiAgICBpZiAoY2FjaGVFbmFibGVkICYmIHNjcm9sbGJhcldpZHRoICE9PSBmYWxzZSkgcmV0dXJuIHNjcm9sbGJhcldpZHRoO1xuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBlbHNlICovXG4gICAgaWYgKHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAoMCwgX2RvbUNzczJbXCJkZWZhdWx0XCJdKShkaXYsIHtcbiAgICAgICAgICAgIHdpZHRoOiAxMDAsXG4gICAgICAgICAgICBoZWlnaHQ6IDEwMCxcbiAgICAgICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgICAgICAgdG9wOiAtOTk5OSxcbiAgICAgICAgICAgIG92ZXJmbG93OiAnc2Nyb2xsJyxcbiAgICAgICAgICAgIE1zT3ZlcmZsb3dTdHlsZTogJ3Njcm9sbGJhcidcbiAgICAgICAgfSk7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZGl2KTtcbiAgICAgICAgc2Nyb2xsYmFyV2lkdGggPSBkaXYub2Zmc2V0V2lkdGggLSBkaXYuY2xpZW50V2lkdGg7XG4gICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZGl2KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBzY3JvbGxiYXJXaWR0aCA9IDA7XG4gICAgfVxuICAgIHJldHVybiBzY3JvbGxiYXJXaWR0aCB8fCAwO1xufSIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBpc1N0cmluZztcbmZ1bmN0aW9uIGlzU3RyaW5nKG1heWJlKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBtYXliZSA9PT0gJ3N0cmluZyc7XG59IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gcmV0dXJuRmFsc2U7XG5mdW5jdGlvbiByZXR1cm5GYWxzZSgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG59Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9